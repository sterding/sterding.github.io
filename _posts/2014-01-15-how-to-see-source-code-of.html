---
layout: post
title: How to see source code of a function/method in R?
date: '2014-01-15T17:47:00.000-05:00'
author: Xianjun Dong
tags:
- getMethod
- S4
- R
modified_time: '2014-01-15T17:47:50.166-05:00'
blogger_id: tag:blogger.com,1999:blog-12445049.post-7902206192721062106
blogger_orig_url: http://onetipperday.blogspot.com/2014/01/how-to-see-source-code-of.html
---

If it's an internal function of R (e.g. from base package), just type the function name, like<br /><div class="p1"><span style="font-family: Courier New, Courier, monospace;">&gt; rowMeans</span></div><div class="p1"><span style="font-family: Courier New, Courier, monospace;">function (x, na.rm = FALSE, dims = 1L)&nbsp;</span></div><div class="p1"><span style="font-family: Courier New, Courier, monospace;">{</span></div><div class="p1"><span style="font-family: Courier New, Courier, monospace;">&nbsp; &nbsp; if (is.data.frame(x))&nbsp;</span></div><div class="p1"><span style="font-family: Courier New, Courier, monospace;">&nbsp; &nbsp; &nbsp; &nbsp; x &lt;- as.matrix(x)</span></div><div class="p1"><span style="font-family: Courier New, Courier, monospace;">&nbsp; &nbsp; if (!is.array(x) || length(dn &lt;- dim(x)) &lt; 2L)&nbsp;</span></div><div class="p1"><span style="font-family: Courier New, Courier, monospace;">&nbsp; &nbsp; &nbsp; &nbsp; stop("'x' must be an array of at least two dimensions")</span></div><div class="p1"><span style="font-family: Courier New, Courier, monospace;">&nbsp; &nbsp; if (dims &lt; 1L || dims &gt; length(dn) - 1L)&nbsp;</span></div><div class="p1"><span style="font-family: Courier New, Courier, monospace;">&nbsp; &nbsp; &nbsp; &nbsp; stop("invalid 'dims'")</span></div><div class="p1"><span style="font-family: Courier New, Courier, monospace;">&nbsp; &nbsp; p &lt;- prod(dn[-(1L:dims)])</span></div><div class="p1"><span style="font-family: Courier New, Courier, monospace;">&nbsp; &nbsp; dn &lt;- dn[1L:dims]</span></div><div class="p1"><span style="font-family: Courier New, Courier, monospace;">&nbsp; &nbsp; z &lt;- if (is.complex(x))&nbsp;</span></div><div class="p1"><span style="font-family: Courier New, Courier, monospace;">&nbsp; &nbsp; &nbsp; &nbsp; .Internal(rowMeans(Re(x), prod(dn), p, na.rm)) + (0+1i) *&nbsp;</span></div><div class="p1"><span style="font-family: Courier New, Courier, monospace;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; .Internal(rowMeans(Im(x), prod(dn), p, na.rm))</span></div><div class="p1"><span style="font-family: Courier New, Courier, monospace;">&nbsp; &nbsp; else .Internal(rowMeans(x, prod(dn), p, na.rm))</span></div><div class="p1"><span style="font-family: Courier New, Courier, monospace;">&nbsp; &nbsp; if (length(dn) &gt; 1L) {</span></div><div class="p1"><span style="font-family: Courier New, Courier, monospace;">&nbsp; &nbsp; &nbsp; &nbsp; dim(z) &lt;- dn</span></div><div class="p1"><span style="font-family: Courier New, Courier, monospace;">&nbsp; &nbsp; &nbsp; &nbsp; dimnames(z) &lt;- dimnames(x)[1L:dims]</span></div><div class="p1"><span style="font-family: Courier New, Courier, monospace;">&nbsp; &nbsp; }</span></div><div class="p1"><span style="font-family: Courier New, Courier, monospace;">&nbsp; &nbsp; else names(z) &lt;- dimnames(x)[[1L]]</span></div><div class="p1"><span style="font-family: Courier New, Courier, monospace;">&nbsp; &nbsp; z</span></div><div class="p1"><span style="font-family: Courier New, Courier, monospace;">}</span></div><div class="p1"><span style="font-family: Courier New, Courier, monospace;">&lt;bytecode: 0x111390028&gt;</span></div><br /><div class="p1"><span style="font-family: Courier New, Courier, monospace;">&lt;environment: namespace:base&gt;</span></div><div class="p1"><br /></div><div class="p1">If it's a S4 function in a package, e.g. to see the code of plotMA in the <a href="http://www.bioconductor.org/packages/2.13/bioc/html/DESeq2.html">DESeq2</a> package, first find the object it belongs to using <span style="color: red; font-family: Courier New, Courier, monospace;"><b>showMethods()</b></span>, like</div><div class="p1"><span style="font-family: Courier New, Courier, monospace;">&gt; showMethods('plotMA')</span></div><div class="p1"><span style="font-family: Courier New, Courier, monospace;">Function: plotMA (package BiocGenerics)</span></div><div class="p1"><span style="font-family: Courier New, Courier, monospace;">object="ANY"</span></div><div class="p1"><span style="font-family: Courier New, Courier, monospace;">object="character"</span></div><div class="p1"><span style="font-family: Courier New, Courier, monospace;">&nbsp; &nbsp; (inherited from: object="ANY")</span></div><div class="p1">            </div><div class="p1"><span style="font-family: Courier New, Courier, monospace;">object="DESeqDataSet"</span></div><div class="p1"><br /></div><div class="p1">then to get source code by <span style="color: red; font-family: Courier New, Courier, monospace;"><b>getMethod()</b></span>,&nbsp;</div><div class="p1"><span style="font-family: Courier New, Courier, monospace;">&gt; getMethod("plotMA","DESeqDataSet")</span></div><div class="p1"><span style="font-family: Courier New, Courier, monospace;">Method Definition:</span></div><div class="p2"><span style="font-family: Courier New, Courier, monospace;"><br /></span></div><div class="p1"><span style="font-family: Courier New, Courier, monospace;">function (object, ...)&nbsp;</span></div><div class="p1"><span style="font-family: Courier New, Courier, monospace;">{</span></div><div class="p1"><span style="font-family: Courier New, Courier, monospace;">&nbsp; &nbsp; .local &lt;- function (object, lfcColname, pvalues, pvalCutoff = 0.1,&nbsp;</span></div><div class="p1"><span style="font-family: Courier New, Courier, monospace;">&nbsp; &nbsp; &nbsp; &nbsp; ylim, linecol = "#ff000080", pointcol = c("black", "red"),&nbsp;</span></div><div class="p1"><span style="font-family: Courier New, Courier, monospace;">&nbsp; &nbsp; &nbsp; &nbsp; xlab, ylab, log = "x", cex = 0.45, ...)&nbsp;</span></div><div class="p1"><span style="font-family: Courier New, Courier, monospace;">&nbsp; &nbsp; {</span></div><div class="p1"><span style="font-family: Courier New, Courier, monospace;">&nbsp; &nbsp; &nbsp; &nbsp; if (missing(xlab))&nbsp;</span></div><div class="p1"><span style="font-family: Courier New, Courier, monospace;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; xlab &lt;- "mean of normalized counts"</span></div><div class="p1"><span style="font-family: Courier New, Courier, monospace;">&nbsp; &nbsp; &nbsp; &nbsp; if (missing(ylab))&nbsp;</span></div><div class="p1"><span style="font-family: Courier New, Courier, monospace;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ylab &lt;- expression(log[2] ~ fold ~ change)</span></div><div class="p1"><span style="font-family: Courier New, Courier, monospace;">&nbsp; &nbsp; &nbsp; &nbsp; if (!missing(pvalues)) {</span></div><div class="p1"><span style="font-family: Courier New, Courier, monospace;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (length(pvalues) != nrow(object)) {</span></div><div class="p1"><span style="font-family: Courier New, Courier, monospace;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; stop("length of pvalues should be equal to the number of rows of object")</span></div><div class="p1"><span style="font-family: Courier New, Courier, monospace;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</span></div><div class="p1"><span style="font-family: Courier New, Courier, monospace;">&nbsp; &nbsp; &nbsp; &nbsp; }</span></div><div class="p1"><span style="font-family: Courier New, Courier, monospace;">&nbsp; &nbsp; &nbsp; &nbsp; stopifnot(length(pointcol) == 2)</span></div><div class="p1"><span style="font-family: Courier New, Courier, monospace;">&nbsp; &nbsp; &nbsp; &nbsp; if (!"results" %in% mcols(mcols(object))$type) {</span></div><div class="p1"><span style="font-family: Courier New, Courier, monospace;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; stop("first run DESeq() in order to produce an MA-plot")</span></div><div class="p1"><span style="font-family: Courier New, Courier, monospace;">&nbsp; &nbsp; &nbsp; &nbsp; }</span></div><div class="p1"><span style="font-family: Courier New, Courier, monospace;">&nbsp; &nbsp; &nbsp; &nbsp; if (missing(lfcColname)) {</span></div><div class="p1"><span style="font-family: Courier New, Courier, monospace;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; lfcColname &lt;- lastCoefName(object)</span></div><div class="p1"><span style="font-family: Courier New, Courier, monospace;">&nbsp; &nbsp; &nbsp; &nbsp; }</span></div><div class="p1"><span style="font-family: Courier New, Courier, monospace;">&nbsp; &nbsp; &nbsp; &nbsp; if (length(lfcColname) != 1 | !is.character(lfcColname)) {</span></div><div class="p1"><span style="font-family: Courier New, Courier, monospace;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; stop("the argument 'lfcColname' should be a character vector of length 1")</span></div><div class="p1"><span style="font-family: Courier New, Courier, monospace;">&nbsp; &nbsp; &nbsp; &nbsp; }</span></div><div class="p1"><span style="font-family: Courier New, Courier, monospace;">&nbsp; &nbsp; &nbsp; &nbsp; if (missing(pvalues)) {</span></div><div class="p1"><span style="font-family: Courier New, Courier, monospace;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; res &lt;- results(object, name = lfcColname)</span></div><div class="p1"><span style="font-family: Courier New, Courier, monospace;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; pvalues &lt;- res$padj</span></div><div class="p1"><span style="font-family: Courier New, Courier, monospace;">&nbsp; &nbsp; &nbsp; &nbsp; }</span></div><div class="p1"><span style="font-family: Courier New, Courier, monospace;">&nbsp; &nbsp; &nbsp; &nbsp; x &lt;- mcols(object)</span></div><div class="p1"><span style="font-family: Courier New, Courier, monospace;">&nbsp; &nbsp; &nbsp; &nbsp; stopifnot(length(cex) == 1)</span></div><div class="p1"><span style="font-family: Courier New, Courier, monospace;">&nbsp; &nbsp; &nbsp; &nbsp; col &lt;- ifelse(is.na(pvalues) | pvalues &gt; pvalCutoff,&nbsp;</span></div><div class="p1"><span style="font-family: Courier New, Courier, monospace;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; pointcol[1], pointcol[2])</span></div><div class="p1"><span style="font-family: Courier New, Courier, monospace;">&nbsp; &nbsp; &nbsp; &nbsp; col = col[x$baseMean &gt; 0]</span></div><div class="p1"><span style="font-family: Courier New, Courier, monospace;">&nbsp; &nbsp; &nbsp; &nbsp; x = x[x$baseMean &gt; 0, ]</span></div><div class="p1"><span style="font-family: Courier New, Courier, monospace;">&nbsp; &nbsp; &nbsp; &nbsp; py = x[, lfcColname]</span></div><div class="p1"><span style="font-family: Courier New, Courier, monospace;">&nbsp; &nbsp; &nbsp; &nbsp; if (missing(ylim))&nbsp;</span></div><div class="p1"><span style="font-family: Courier New, Courier, monospace;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ylim = c(-1, 1) * quantile(abs(py[is.finite(py)]),&nbsp;</span></div><div class="p1"><span style="font-family: Courier New, Courier, monospace;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; probs = 0.99) * 1.1</span></div><div class="p1"><span style="font-family: Courier New, Courier, monospace;">&nbsp; &nbsp; &nbsp; &nbsp; plot(x$baseMean, pmax(ylim[1], pmin(ylim[2], py)), log = log,&nbsp;</span></div><div class="p1"><span style="font-family: Courier New, Courier, monospace;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; pch = ifelse(py &lt; ylim[1], 6, ifelse(py &gt; ylim[2],&nbsp;</span></div><div class="p1"><span style="font-family: Courier New, Courier, monospace;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 2, 20)), cex = cex, col = col, xlab = xlab, ylab = ylab,&nbsp;</span></div><div class="p1"><span style="font-family: Courier New, Courier, monospace;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ylim = ylim, ...)</span></div><div class="p1"><span style="font-family: Courier New, Courier, monospace;">&nbsp; &nbsp; &nbsp; &nbsp; abline(h = 0, lwd = 4, col = linecol)</span></div><div class="p1"><span style="font-family: Courier New, Courier, monospace;">&nbsp; &nbsp; }</span></div><div class="p1"><span style="font-family: Courier New, Courier, monospace;">&nbsp; &nbsp; .local(object, ...)</span></div><div class="p1"><span style="font-family: Courier New, Courier, monospace;">}</span></div><div class="p1"><span style="font-family: Courier New, Courier, monospace;">&lt;environment: namespace:DESeq2&gt;</span></div><div class="p2"><span style="font-family: Courier New, Courier, monospace;"><br /></span></div><div class="p1"><span style="font-family: Courier New, Courier, monospace;">Signatures:</span></div><div class="p1"><span style="font-family: Courier New, Courier, monospace;">&nbsp; &nbsp; &nbsp; &nbsp; object &nbsp; &nbsp; &nbsp; &nbsp;</span></div><div class="p1"><span style="font-family: Courier New, Courier, monospace;">target&nbsp; "DESeqDataSet"</span></div><div class="p1">                                                              </div><div class="p1"><span style="font-family: Courier New, Courier, monospace;">defined "DESeqDataSet"</span></div><br />Reference:&nbsp;http://stackoverflow.com/questions/5937832/r-show-source-code-of-an-s4-function-in-a-package