---
layout: post
title: best note on reshape2
date: '2014-07-15T14:54:00.000-04:00'
author: Xianjun Dong
tags:
- reshape2
- ggplot
- format converter
- R
modified_time: '2015-05-07T16:43:05.559-04:00'
blogger_id: tag:blogger.com,1999:blog-12445049.post-20900226337850898
blogger_orig_url: http://onetipperday.blogspot.com/2014/07/best-note-on-reshape2.html
---

I found this elegant note about reshape2 from Sean Anderson's blog:<br /><a href="http://seananderson.ca/2013/10/19/reshape.html" target="_blank">http://seananderson.ca/2013/10/19/reshape.html</a><br /><br />Basically,<br /><br /><span style="font-family: Courier New, Courier, monospace;"><b>reshape2</b></span> is based around two key functions: <span style="font-family: Courier New, Courier, monospace;"><b>melt</b></span> and <span style="font-family: Courier New, Courier, monospace;"><b>cast</b></span>:<br /><b><span style="font-family: Courier New, Courier, monospace;">melt</span></b> takes wide-format data and melts it into long-format data.<br /><b><span style="font-family: Courier New, Courier, monospace;">cast</span></b> takes long-format data and casts it into wide-format data.<br /><div><br /></div><div>For example, this is wide format:</div><div><br /></div><div><div class="p1"><span style="font-family: Courier New, Courier, monospace;">&gt; head(fpkm)</span></div><div class="p1"><span style="font-family: Courier New, Courier, monospace;">ID &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;FPKM.SRR1069188 FPKM.SRR1070986 FPKM.SRR1071289</span></div><div class="p1"><span style="font-family: Courier New, Courier, monospace;">ENSG00000240361.1&nbsp; &nbsp; &nbsp; 1.00000000&nbsp; &nbsp; &nbsp; &nbsp; 1.000000&nbsp; &nbsp; &nbsp; &nbsp; 1.000000</span></div><div class="p1"><span style="font-family: Courier New, Courier, monospace;">ENSG00000186092.4&nbsp; &nbsp; &nbsp; 1.00000000&nbsp; &nbsp; &nbsp; &nbsp; 1.000000&nbsp; &nbsp; &nbsp; &nbsp; 1.000000</span></div><div class="p1"><span style="font-family: Courier New, Courier, monospace;">ENSG00000237613.2&nbsp; &nbsp; &nbsp; 1.00000000&nbsp; &nbsp; &nbsp; &nbsp; 1.000000&nbsp; &nbsp; &nbsp; &nbsp; 1.000000</span></div><div class="p1"><span style="font-family: Courier New, Courier, monospace;">ENSG00000239906.1&nbsp; &nbsp; &nbsp; 0.05888838&nbsp; &nbsp; &nbsp; &nbsp; 5.139312&nbsp; &nbsp; &nbsp; &nbsp; 5.055983</span></div><div class="p1"><span style="font-family: Courier New, Courier, monospace;">ENSG00000241860.1&nbsp; &nbsp; &nbsp; 1.20237363&nbsp; &nbsp; &nbsp; &nbsp; 1.160175&nbsp; &nbsp; &nbsp; &nbsp; 1.085992</span></div><div class="p1"><span style="font-family: Courier New, Courier, monospace;">ENSG00000222623.1&nbsp; &nbsp; &nbsp; 1.00000000&nbsp; &nbsp; &nbsp; &nbsp; 1.000000&nbsp; &nbsp; &nbsp; &nbsp; 1.000000</span></div><div class="p1"><br /></div>Using melt to change it into long format:<br /><br /><div class="p1"></div><div class="p1"><span style="font-family: Courier New, Courier, monospace;">&gt;require('reshape2')</span></div><div class="p1"></div><div class="p1"><span style="font-family: Courier New, Courier, monospace;">&gt;head(melt(fpkm))</span></div><div class="p1"><span style="font-family: Courier New, Courier, monospace;">No id variables; using all as measure variables</span></div><div class="p1"><span style="font-family: Courier New, Courier, monospace;">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; variable&nbsp; &nbsp; &nbsp; value</span></div><div class="p1"><span style="font-family: Courier New, Courier, monospace;">1 FPKM.SRR1069188 1.00000000</span></div><div class="p1"><span style="font-family: Courier New, Courier, monospace;">2 FPKM.SRR1069188 1.00000000</span></div><div class="p1"><span style="font-family: Courier New, Courier, monospace;">3 FPKM.SRR1069188 1.00000000</span></div><div class="p1"><span style="font-family: Courier New, Courier, monospace;">4 FPKM.SRR1069188 0.05888838</span></div><div class="p1"><span style="font-family: Courier New, Courier, monospace;">5 FPKM.SRR1069188 1.20237363</span></div><div class="p1"></div><div class="p1"><span style="font-family: Courier New, Courier, monospace;">6 FPKM.SRR1069188 1.00000000</span></div><div class="p1"><br /></div><div class="p1">or, you can set the column name by</div><div class="p1"><br /></div><div class="p1"><span style="font-family: Courier New, Courier, monospace;">&gt; head(melt(fpkm, variable.name = "Sample",value.name ="FPKM"))</span></div><div class="p1"><span style="font-family: Courier New, Courier, monospace;">No id variables; using all as measure variables</span></div><div class="p1"><span style="font-family: Courier New, Courier, monospace;">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Sample &nbsp; &nbsp; &nbsp; FPKM</span></div><div class="p1"><span style="font-family: Courier New, Courier, monospace;">1 FPKM.SRR1069188 1.00000000</span></div><div class="p1"><span style="font-family: Courier New, Courier, monospace;">2 FPKM.SRR1069188 1.00000000</span></div><div class="p1"><span style="font-family: Courier New, Courier, monospace;">3 FPKM.SRR1069188 1.00000000</span></div><div class="p1"><span style="font-family: Courier New, Courier, monospace;">4 FPKM.SRR1069188 0.05888838</span></div><div class="p1"><span style="font-family: Courier New, Courier, monospace;">5 FPKM.SRR1069188 1.20237363</span></div><div class="p1"></div><div class="p1"><span style="font-family: Courier New, Courier, monospace;">6 FPKM.SRR1069188 1.00000000</span></div><div class="p1"><br /></div><div class="p1">if you want, you can also keep some of columns as ID in the long format, for example, I want to keep the gene ID in the long format:</div><div class="p1"><br /></div><div class="p1"></div><div class="p1"><span style="font-family: Courier New, Courier, monospace;">&gt;head(melt(fpkm, variable.name = "Sample",value.name ="FPKM", id="ID"))</span></div><div class="p1"><span style="font-family: Courier New, Courier, monospace;">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ID&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Sample &nbsp; &nbsp; &nbsp; FPKM</span></div><div class="p1"><span style="font-family: Courier New, Courier, monospace;">1 ENSG00000240361.1 FPKM.SRR1069188 1.00000000</span></div><div class="p1"><span style="font-family: Courier New, Courier, monospace;">2 ENSG00000186092.4 FPKM.SRR1069188 1.00000000</span></div><div class="p1"><span style="font-family: Courier New, Courier, monospace;">3 ENSG00000237613.2 FPKM.SRR1069188 1.00000000</span></div><div class="p1"><span style="font-family: Courier New, Courier, monospace;">4 ENSG00000239906.1 FPKM.SRR1069188 0.05888838</span></div><div class="p1"><span style="font-family: Courier New, Courier, monospace;">5 ENSG00000241860.1 FPKM.SRR1069188 1.20237363</span></div><div class="p1"></div><div class="p1"><span style="font-family: Courier New, Courier, monospace;">6 ENSG00000222623.1 FPKM.SRR1069188 1.00000000</span></div><div class="p1"><br /></div><div class="p1">I will do the long--&gt;wide example when I have a good case to show... :)<br /><br />Update: see <a href="http://onetipperday.blogspot.com/2015/02/reshape-from-long-to-wide-format.html">this post </a>of the long--&gt;wide conversion.&nbsp;</div></div>