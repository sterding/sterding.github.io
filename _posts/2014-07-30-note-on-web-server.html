---
layout: post
title: note on web server
date: '2014-07-30T15:56:00.002-04:00'
author: Xianjun Dong
tags:
- web server
- Aparche
- web
modified_time: '2014-10-21T17:41:42.300-04:00'
blogger_id: tag:blogger.com,1999:blog-12445049.post-7938964358286199057
blogger_orig_url: http://onetipperday.blogspot.com/2014/07/note-on-web-server.html
---

Note: Below tips are based on CentOS (member of RedHat family, incl. Fedora). For other systems, like Debian/Ubuntu/Mint/SUSE/Mac OS, this may not work. <br /><br /><b>1. How to add new users?</b><br /><div><br /></div><div><span style="font-family: Courier New, Courier, monospace;">$ sudo vi /etc/group&nbsp;</span></div><div>and find line with&nbsp;</div><div><div class="p1"><span style="font-family: Courier New, Courier, monospace;">users:x:100:xxx,yyy,zzz</span></div><div class="p1">and add new username behind.&nbsp;</div><div class="p1"><br /></div><div class="p1">* for an independent system (unlike ours which is a virtual server attached to the main cluster), you may want to use&nbsp;<span style="font-family: Courier New, Courier, monospace;">useradd &lt;username&gt;</span> to add new users. See detail <a href="https://www.centos.org/docs/5/html/5.1/Deployment_Guide/s2-users-add.html" target="_blank">here</a>.</div><div class="p1"><br /></div></div><div><b>2. How to Enable Userdir (Public_html)?</b><br /><div><br /></div><div><span style="font-family: Courier New, Courier, monospace;">$ sudo vi /etc/httpd/conf/httpd.conf&nbsp;</span></div></div><div>and find the following part and&nbsp;</div><div><div class="p1"><span style="font-family: Courier New, Courier, monospace;"><span class="s1">&lt;IfModule</span> mod_userdir.c<span class="s1">&gt;</span></span></div><div class="p2"><span style="font-family: 'Courier New', Courier, monospace;">&nbsp; &nbsp; #</span><span class="s2" style="font-family: 'Courier New', Courier, monospace;">UserDir</span><span style="font-family: 'Courier New', Courier, monospace;"> disabled</span></div><div class="p3"><span style="font-family: Courier New, Courier, monospace;">&nbsp; &nbsp; <span class="s2">UserDir</span> enabled&nbsp;xxx yyy zzz</span></div><div class="p3"><span style="font-family: Courier New, Courier, monospace;">&nbsp; &nbsp; <span class="s2">UserDir</span> public_html</span></div><div class="p5"><span style="font-family: Courier New, Courier, monospace;">&lt;/IfModule&gt;</span></div><div class="p5"><span style="font-family: Courier New, Courier, monospace;"><br /></span></div>then restart apache by<br /><div class="p5"><span style="font-family: Courier New, Courier, monospace;">$ sudo /etc/rc.d/init.d/httpd restart</span></div><div class="p5"><span style="font-family: Courier New, Courier, monospace;"><br /></span></div><div>Now you should be able to see the file content:</div><div>http://yourdomain.name/~xxx<br /><br />If you got a 403 error, you should change the folder/file permission to 0755 and 0644, respectively.&nbsp;</div><div><br /><b>3. How to change permission to a folder and all of its subfolders and files?</b><br /><b><br /></b><div style="background: rgb(255, 255, 255); border: 0px; clear: both; font-family: Arial, 'Liberation Sans', 'DejaVu Sans', sans-serif; font-size: 14px; line-height: 17.804800033569336px; margin-bottom: 1em; padding: 0px; vertical-align: baseline;">To set the directories to 755 and set the files to 644, you can use the&nbsp;<code style="background: rgb(238, 238, 238); border: 0px; font-family: Consolas, Menlo, Monaco, 'Lucida Console', 'Liberation Mono', 'DejaVu Sans Mono', 'Bitstream Vera Sans Mono', 'Courier New', monospace, serif; margin: 0px; padding: 1px 5px; vertical-align: baseline; white-space: pre-wrap;">find</code>&nbsp;command. For example:</div><div style="background: rgb(255, 255, 255); border: 0px; clear: both; font-family: Arial, 'Liberation Sans', 'DejaVu Sans', sans-serif; font-size: 14px; line-height: 17.804800033569336px; margin-bottom: 1em; padding: 0px; vertical-align: baseline;">To change all the directories to 755 (-rwxr-xr-x):</div><pre style="background: rgb(238, 238, 238); border: 0px; font-family: Consolas, Menlo, Monaco, 'Lucida Console', 'Liberation Mono', 'DejaVu Sans Mono', 'Bitstream Vera Sans Mono', 'Courier New', monospace, serif; font-size: 14px; line-height: 17.804800033569336px; margin-bottom: 10px; max-height: 600px; overflow: auto; padding: 5px; vertical-align: baseline; width: auto; word-wrap: normal;"><code style="background-attachment: initial; background-clip: initial; background-image: initial; background-origin: initial; background-position: initial; background-repeat: initial; background-size: initial; border: 0px; font-family: Consolas, Menlo, Monaco, 'Lucida Console', 'Liberation Mono', 'DejaVu Sans Mono', 'Bitstream Vera Sans Mono', 'Courier New', monospace, serif; margin: 0px; padding: 0px; vertical-align: baseline; white-space: inherit;">find <span style="white-space: inherit;">~/public_html/myfolder</span></code><span style="white-space: inherit;"> -type d -exec chmod 755 {} \;</span></pre><div style="background: rgb(255, 255, 255); border: 0px; clear: both; font-family: Arial, 'Liberation Sans', 'DejaVu Sans', sans-serif; font-size: 14px; line-height: 17.804800033569336px; margin-bottom: 1em; padding: 0px; vertical-align: baseline;">To change all the files to 644 (-rw-r--r--):</div><pre style="background: rgb(238, 238, 238); border: 0px; font-family: Consolas, Menlo, Monaco, 'Lucida Console', 'Liberation Mono', 'DejaVu Sans Mono', 'Bitstream Vera Sans Mono', 'Courier New', monospace, serif; font-size: 14px; line-height: 17.804800033569336px; margin-bottom: 10px; max-height: 600px; overflow: auto; padding: 5px; vertical-align: baseline; width: auto; word-wrap: normal;"><code style="background-attachment: initial; background-clip: initial; background-image: initial; background-origin: initial; background-position: initial; background-repeat: initial; background-size: initial; border: 0px; font-family: Consolas, Menlo, Monaco, 'Lucida Console', 'Liberation Mono', 'DejaVu Sans Mono', 'Bitstream Vera Sans Mono', 'Courier New', monospace, serif; margin: 0px; padding: 0px; vertical-align: baseline; white-space: inherit;">find ~/public_html/myfolder -type f -exec chmod 644 {} \;</code></pre>Ref:&nbsp;<a href="http://stackoverflow.com/questions/3740152/how-to-set-chmod-for-a-folder-and-all-of-its-subfolders-and-files-in-linux-ubunt">http://stackoverflow.com/questions/3740152/how-to-set-chmod-for-a-folder-and-all-of-its-subfolders-and-files-in-linux-ubunt</a><br /><br /><b>4. How to set password for Userdir (Public_html)?</b><br /><div><br /></div>Change to and/or specify directory to protect in&nbsp;<span style="font-family: Courier New, Courier, monospace;">/etc/httpd/conf/httpd.conf</span>:</div><div> <dl style="background-color: #cccccc; font-family: helvetica, arial, sans-serif;"><dd><table bgcolor="#000000" border="1" cellpadding="4" cellspacing="1" style="width: 100%px;"><tbody><tr bgcolor="#c0c0c0"><td><pre>&lt;Directory <i>/home/xxx/public_html</i>&gt;<br />     AllowOverride All<br />&lt;/Directory&gt;<br />               </pre></td></tr></tbody></table></dd></dl>OR <br /><dl style="background-color: #cccccc; font-family: helvetica, arial, sans-serif;"><dd><table bgcolor="#000000" border="1" cellpadding="4" cellspacing="1" style="width: 100%px;"><tbody><tr bgcolor="#c0c0c0"><td><pre>&lt;Directory <i>/home/xxx/public_html</i>&gt;<br />     AllowOverride AuthConfig<br />&lt;/Directory&gt;</pre></td></tr></tbody></table></dd></dl></div>Create a file /home/xxx/public_html/.htaccess in that director that looks something like this: <br /><dl style="background-color: #cccccc; font-family: helvetica, arial, sans-serif;"><dd><table bgcolor="#000000" border="1" cellpadding="4" cellspacing="1" style="width: 100%px;"><tbody><tr bgcolor="#c0c0c0"><td><pre>     AuthName "<i>Add your login message here.</i>"<br />     AuthType Basic<br />     AuthUserFile /home/<i>xxx</i>/public_html/.htpasswd<br />     AuthGroupFile /dev/null<br />     require user <i>name-of-user</i></pre></td></tr></tbody></table></dd></dl>In this case the "name-of-user" is the login name you wish to use for accessing the web site.<br /><br />Create (or clobber if it already exists) the password file /home/xxx/public_html/.htpasswd using the program htpasswd: <br /><span style="font-family: Courier New, Courier, monospace;"> htpasswd -c .htpasswd name-of-user  </span></div><div>Add a new user to the existing password file: <br /><span style="font-family: Courier New, Courier, monospace;">         htpasswd .htpasswd name-of-user</span><br />Password file protection, ownership attributes:<br />File privileges: <span style="font-family: Courier New, Courier, monospace;">chmod ug+rw .htpasswd</span><br />File ownership: <span style="font-family: Courier New, Courier, monospace;">chown apache.apache .htpasswd</span><br /><span style="font-family: Courier New, Courier, monospace;"><br /></span>More method on encrypting a site can be found here: http://www.yolinux.com/TUTORIALS/LinuxTutorialApacheAddingLoginSiteProtection.html<br />Updating...</div>