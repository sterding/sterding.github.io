---
layout: post
title: Extract unmapped / unpaired reads using bowtie2
date: '2012-08-30T10:43:00.002-04:00'
author: Xianjun Dong
tags:
- next-generation sequencing
- bioinformatics
- bowtie2
modified_time: '2012-08-30T10:47:25.368-04:00'
blogger_id: tag:blogger.com,1999:blog-12445049.post-6894913198666913321
blogger_orig_url: http://onetipperday.blogspot.com/2012/08/extract-unmapped-unpaired-reads-using.html
---

There are options in Bowtie2 for unmapped reads:<br /><table style="background-color: white; color: #666666; font-family: Verdana, Arial, sans-serif; font-size: 12.800000190734863px; line-height: 20.479999542236328px; margin: 15px 0px 0px; padding: 0px; text-align: start;"><tbody style="margin: 0px; padding: 0px;"><tr style="margin: 0px; padding: 0px;"><td id="bowtie2-options-un" style="margin: 0px; padding: 0px; vertical-align: top;"><pre style="margin-bottom: 15px; margin-left: 25px; margin-right: 15px; padding: 0px;"><code style="font-family: 'Courier New', Courier; margin: 0px; padding: 0px;">--un &lt;path&gt;<br /><br /><br /></code></pre></td><td style="margin: 0px; padding: 0px; vertical-align: top;"><div style="color: #444444; margin-bottom: 10px; margin-left: 15px; margin-right: 15px; padding: 0px;">Write unpaired reads that fail to align to file at&nbsp;<code style="font-family: 'Courier New', Courier; margin: 0px; padding: 0px;">&lt;path&gt;</code>. These reads correspond to the SAM records with the FLAGS&nbsp;<code style="font-family: 'Courier New', Courier; margin: 0px; padding: 0px;">0x4</code>&nbsp;bit set and neither the&nbsp;<code style="font-family: 'Courier New', Courier; margin: 0px; padding: 0px;">0x40</code>&nbsp;nor&nbsp;<code style="font-family: 'Courier New', Courier; margin: 0px; padding: 0px;">0x80</code>&nbsp;bits set.&nbsp;</div></td></tr><tr style="margin: 0px; padding: 0px;"><td id="bowtie2-options-al" style="margin: 0px; padding: 0px; vertical-align: top;"><pre style="margin-bottom: 15px; margin-left: 25px; margin-right: 15px; padding: 0px;"><code style="font-family: 'Courier New', Courier; margin: 0px; padding: 0px;">--al &lt;path&gt;<br /><br /><br /></code></pre></td><td style="margin: 0px; padding: 0px; vertical-align: top;"><div style="color: #444444; margin-bottom: 10px; margin-left: 15px; margin-right: 15px; padding: 0px;">Write unpaired reads that align at least once to file at&nbsp;<code style="font-family: 'Courier New', Courier; margin: 0px; padding: 0px;">&lt;path&gt;</code>. These reads correspond to the SAM records with the FLAGS&nbsp;<code style="font-family: 'Courier New', Courier; margin: 0px; padding: 0px;">0x4</code>,&nbsp;<code style="font-family: 'Courier New', Courier; margin: 0px; padding: 0px;">0x40</code>, and&nbsp;<code style="font-family: 'Courier New', Courier; margin: 0px; padding: 0px;">0x80</code>&nbsp;bits unset.</div></td></tr></tbody></table><span style="font-family: Courier New, Courier, monospace;">--un</span> is path to save unmapped reads (in FASTQ format), and <span style="font-family: Courier New, Courier, monospace;">--al</span> is to save all aligned reads (including multiple mappers). &nbsp;<b><u>What's worthy to note is, <span style="font-family: Courier New, Courier, monospace;">--un</span> only works when&nbsp;<span style="background-color: white; color: #666666; line-height: 20.479999542236328px;"><span style="font-family: Courier New, Courier, monospace;">--no-unal</span></span><span style="background-color: white; color: #666666; font-family: 'Courier New', Courier; line-height: 20.479999542236328px;">&nbsp;</span>option is unset</u></b> (i.e. if --no-unal is set, --un &lt;file&gt; will be empty).<br /><br />These two options are both for single-reads (SR). For paired-end(PE) reads, there are another two corresponding options:<br /><table style="background-color: white; color: #666666; font-family: Verdana, Arial, sans-serif; font-size: 12.800000190734863px; line-height: 20.479999542236328px; margin: 15px 0px 0px; padding: 0px; text-align: start;"><tbody style="margin: 0px; padding: 0px;"><tr style="margin: 0px; padding: 0px;"><td id="bowtie2-options-un-conc" style="margin: 0px; padding: 0px; vertical-align: top;"><pre style="margin-bottom: 15px; margin-left: 25px; margin-right: 15px; padding: 0px;"><code style="font-family: 'Courier New', Courier; margin: 0px; padding: 0px;">--un-conc &lt;path&gt;<br /></code></pre></td><td style="margin: 0px; padding: 0px; vertical-align: top;"><div style="color: #444444; margin-bottom: 10px; margin-left: 15px; margin-right: 15px; padding: 0px;">Write paired-end reads that fail to align <b><i>concordantly</i></b> to file(s) at&nbsp;<code style="font-family: 'Courier New', Courier; margin: 0px; padding: 0px;">&lt;path&gt;</code>. These reads correspond to the SAM records with the FLAGS&nbsp;<code style="font-family: 'Courier New', Courier; margin: 0px; padding: 0px;">0x4</code>&nbsp;bit set and either the&nbsp;<code style="font-family: 'Courier New', Courier; margin: 0px; padding: 0px;">0x40</code>&nbsp;or&nbsp;<code style="font-family: 'Courier New', Courier; margin: 0px; padding: 0px;">0x80</code>&nbsp;bit set (depending on whether it's mate #1 or #2).&nbsp;<code style="font-family: 'Courier New', Courier; margin: 0px; padding: 0px;">.1</code>&nbsp;and&nbsp;<code style="font-family: 'Courier New', Courier; margin: 0px; padding: 0px;">.2</code>&nbsp;strings are added to the filename to distinguish which file contains mate #1 and mate #2. If a percent symbol,&nbsp;<code style="font-family: 'Courier New', Courier; margin: 0px; padding: 0px;">%</code>, is used in&nbsp;<code style="font-family: 'Courier New', Courier; margin: 0px; padding: 0px;">&lt;path&gt;</code>, the percent symbol is replaced with&nbsp;<code style="font-family: 'Courier New', Courier; margin: 0px; padding: 0px;">1</code>&nbsp;or&nbsp;<code style="font-family: 'Courier New', Courier; margin: 0px; padding: 0px;">2</code>&nbsp;to make the per-mate filenames. Otherwise,&nbsp;<code style="font-family: 'Courier New', Courier; margin: 0px; padding: 0px;">.1</code>&nbsp;or&nbsp;<code style="font-family: 'Courier New', Courier; margin: 0px; padding: 0px;">.2</code>&nbsp;are added before the final dot in&nbsp;<code style="font-family: 'Courier New', Courier; margin: 0px; padding: 0px;">&lt;path&gt;</code>&nbsp;to make the per-mate filenames.</div></td></tr><tr style="margin: 0px; padding: 0px;"><td id="bowtie2-options-al-conc" style="margin: 0px; padding: 0px; vertical-align: top;"><pre style="margin-bottom: 15px; margin-left: 25px; margin-right: 15px; padding: 0px;"><code style="font-family: 'Courier New', Courier; margin: 0px; padding: 0px;">--al-conc &lt;path&gt;<br /></code></pre></td><td style="margin: 0px; padding: 0px; vertical-align: top;"><div style="color: #444444; margin-bottom: 10px; margin-left: 15px; margin-right: 15px; padding: 0px;">Write paired-end reads that align concordantly at least once to file(s) at&nbsp;<code style="font-family: 'Courier New', Courier; margin: 0px; padding: 0px;">&lt;path&gt;</code>. These reads correspond to the SAM records with the FLAGS&nbsp;<code style="font-family: 'Courier New', Courier; margin: 0px; padding: 0px;">0x4</code>&nbsp;bit unset and either the&nbsp;<code style="font-family: 'Courier New', Courier; margin: 0px; padding: 0px;">0x40</code>&nbsp;or&nbsp;<code style="font-family: 'Courier New', Courier; margin: 0px; padding: 0px;">0x80</code>&nbsp;bit set (depending on whether it's mate #1 or #2).&nbsp;<code style="font-family: 'Courier New', Courier; margin: 0px; padding: 0px;">.1</code>&nbsp;and&nbsp;<code style="font-family: 'Courier New', Courier; margin: 0px; padding: 0px;">.2</code>&nbsp;strings are added to the filename to distinguish which file contains mate #1 and mate #2. If a percent symbol,&nbsp;<code style="font-family: 'Courier New', Courier; margin: 0px; padding: 0px;">%</code>, is used in&nbsp;<code style="font-family: 'Courier New', Courier; margin: 0px; padding: 0px;">&lt;path&gt;</code>, the percent symbol is replaced with&nbsp;<code style="font-family: 'Courier New', Courier; margin: 0px; padding: 0px;">1</code>&nbsp;or&nbsp;<code style="font-family: 'Courier New', Courier; margin: 0px; padding: 0px;">2</code>&nbsp;to make the per-mate filenames. Otherwise,&nbsp;<code style="font-family: 'Courier New', Courier; margin: 0px; padding: 0px;">.1</code>&nbsp;or&nbsp;<code style="font-family: 'Courier New', Courier; margin: 0px; padding: 0px;">.2</code>&nbsp;are added before the final dot in&nbsp;<code style="font-family: 'Courier New', Courier; margin: 0px; padding: 0px;">&lt;path&gt;</code>&nbsp;to make the per-mate filenames.</div></td></tr></tbody></table><br />As above, <span style="font-family: Courier New, Courier, monospace;">--un-conc</span> is for improperly paired reads ('discordantly', e.g.  both mates are uniquely mapped, but aren't in the expcted relative orientation, or aren't within the expected disatance range, or both, controlled by&nbsp;<a href="http://bowtie-bio.sourceforge.net/bowtie2/manual.shtml#bowtie2-options-fr" style="background-color: white; background: inherit; color: #0066b3; font-family: Verdana, Arial, sans-serif; font-size: 12.800000190734863px; line-height: 20.479999542236328px; margin: 0px; padding: 0px; text-decoration: none;"><code style="font-family: 'Courier New', Courier; margin: 0px; padding: 0px;">--fr</code>/<code style="font-family: 'Courier New', Courier; margin: 0px; padding: 0px;">--rf</code>/<code style="font-family: 'Courier New', Courier; margin: 0px; padding: 0px;">--ff</code></a><span style="background-color: white; color: #444444; font-family: Verdana, Arial, sans-serif; font-size: 12.800000190734863px; line-height: 20.479999542236328px;">,&nbsp;</span><a href="http://bowtie-bio.sourceforge.net/bowtie2/manual.shtml#bowtie2-options-I" style="background-color: white; background: inherit; color: #0066b3; font-family: Verdana, Arial, sans-serif; font-size: 12.800000190734863px; line-height: 20.479999542236328px; margin: 0px; padding: 0px; text-decoration: none;"><code style="font-family: 'Courier New', Courier; margin: 0px; padding: 0px;">-I</code></a><span style="background-color: white; color: #444444; font-family: Verdana, Arial, sans-serif; font-size: 12.800000190734863px; line-height: 20.479999542236328px;">,&nbsp;</span><code style="background-color: white; background: inherit; color: #0066b3; font-family: 'Courier New', Courier; font-size: 12.800000190734863px; line-height: 20.479999542236328px; margin: 0px; padding: 0px; text-decoration: none;"><a href="http://bowtie-bio.sourceforge.net/bowtie2/manual.shtml#bowtie2-options-X" style="background-color: white; background: inherit; color: #0066b3; font-family: Verdana, Arial, sans-serif; font-size: 12.800000190734863px; line-height: 20.479999542236328px; margin: 0px; padding: 0px; text-decoration: none;">-X</a></code> options), <span style="font-family: Courier New, Courier, monospace;">--al-conc</span> is for concordantly paired reads (including multi-mappers). Respectively, <span style="font-family: Courier New, Courier, monospace;">--un-conc</span> only works when&nbsp;<span style="background-color: white; color: #666666; font-family: 'Courier New', Courier; line-height: 20.479999542236328px;">--no-discordant</span> is unset (this is what I guess, not test yet)<br /><br /><br /><br />