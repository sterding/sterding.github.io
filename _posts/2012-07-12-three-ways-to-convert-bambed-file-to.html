---
layout: post
title: Three ways to convert bam/bed file to bigwig, separated by strand
date: '2012-07-12T16:03:00.000-04:00'
author: Xianjun Dong
tags:
- next-generation sequencing
- UCSC
modified_time: '2012-07-12T16:04:08.910-04:00'
blogger_id: tag:blogger.com,1999:blog-12445049.post-8376630175787175328
blogger_orig_url: http://onetipperday.blogspot.com/2012/07/three-ways-to-convert-bambed-file-to.html
---

Here are three ways to convert bam/bed to bigwig, separated by strand:<br /><br /><br /><span style="font-family: 'Courier New', Courier, monospace;"># ----------- &nbsp;method 1</span><br /><span style="font-family: 'Courier New', Courier, monospace;"><br /></span><br /><span style="font-family: 'Courier New', Courier, monospace;">bamToBed -i accepted_hits.bam -split &gt; accepted_hits.bed</span><br /><span style="font-family: 'Courier New', Courier, monospace;"><br /></span><br /><span style="font-family: 'Courier New', Courier, monospace;">awk '{if($6=="+") print}'&nbsp;accepted_hits.bed | sort -k1,1 | bedItemOverlapCount mm9 -chromSize=ChromInfo.txt stdin | sort -k1,1 -k2,2n &gt;&nbsp;accepted_hits.plus.bedGraph</span><br /><span style="font-family: 'Courier New', Courier, monospace;">awk '{if($6=="-") print}'&nbsp;<span style="background-color: white;">accepted_hits</span><span style="background-color: white;">.bed | sort -k1,1 | bedItemOverlapCount mm9 -chromSize=ChromInfo.txt stdin | sort -k1,1 -k2,2n | awk '{OFS="\t"; print $1,$2,$3,"-"$4}' &gt;&nbsp;</span>accepted_hits<span style="background-color: white;">.minus.bedGraph</span></span><br /><div><span style="font-family: 'Courier New', Courier, monospace;"><br /></span></div><div><div><span style="font-family: 'Courier New', Courier, monospace;">bedGraphToBigWig&nbsp;accepted_hits.plus.bedGraph ChromInfo.txt&nbsp;accepted_hits.plus.bw</span></div><div><span style="font-family: 'Courier New', Courier, monospace;">bedGraphToBigWig&nbsp;accepted_hits.minus.bedGraph ChromInfo.txt&nbsp;accepted_hits.minus.bw</span></div></div><div><span style="font-family: 'Courier New', Courier, monospace;"><br /></span></div><div><span style="font-family: 'Courier New', Courier, monospace;"><br /></span></div><div><span style="font-family: 'Courier New', Courier, monospace;"><span style="background-color: white;"># -----------</span><span style="background-color: white;">&nbsp;</span>method 2</span></div><div><span style="font-family: 'Courier New', Courier, monospace;"><br /></span></div><div><span style="font-family: 'Courier New', Courier, monospace;">bamToBed -i accepted_hits.bam -split &gt;&nbsp;accepted_hits.bed</span><br /><span style="font-family: 'Courier New', Courier, monospace;"><br /></span><br /><span style="font-family: 'Courier New', Courier, monospace;">sort -k1,1&nbsp;accepted_hits.bed | awk -v&nbsp;'{print $0 &gt;&gt; "<span style="background-color: white;">accepted_hits</span><span style="background-color: white;">.bed"$6}'</span></span><br /><span style="font-family: 'Courier New', Courier, monospace;">bedItemOverlapCount $index -chromSize=ChromInfo.txt&nbsp;accepted_hits.bed+ | sort -k1,1 -k2,2n &gt;&nbsp;accepted_hits.plus.bedGraph</span><br /><span style="font-family: 'Courier New', Courier, monospace;">bedItemOverlapCount $index -chromSize=ChromInfo.txt&nbsp;accepted_hits.bed- | sort -k1,1 -k2,2n | awk '{OFS="\t"; print $1,$2,$3,"-"$4}' &gt;&nbsp;accepted_hits.minus.bedGraph</span><br /><div><span style="font-family: 'Courier New', Courier, monospace;"><br /></span></div><div><div><span style="font-family: 'Courier New', Courier, monospace;">bedGraphToBigWig&nbsp;accepted_hits.plus.bedGraph ChromInfo.txt&nbsp;accepted_hits.plus.bw</span></div><div><span style="font-family: 'Courier New', Courier, monospace;">bedGraphToBigWig&nbsp;accepted_hits.minus.bedGraph ChromInfo.txt&nbsp;accepted_hits.minus.bw</span></div></div><div><span style="font-family: 'Courier New', Courier, monospace;"><br /></span></div><div><div><span style="font-family: 'Courier New', Courier, monospace;"><br /></span></div><div><span style="font-family: 'Courier New', Courier, monospace;"><span style="background-color: white;"># -----------</span><span style="background-color: white;">&nbsp;</span>method 3</span></div><div><span style="font-family: 'Courier New', Courier, monospace;"><br /></span></div><div><span style="font-family: 'Courier New', Courier, monospace;">bedtools genomecov&nbsp;-ibam&nbsp;-bg -split&nbsp;-strand +&nbsp;<span style="background-color: white;">-i accepted_hits.bam -g&nbsp;</span><span style="background-color: white;">ChromInfo.txt&nbsp;</span><span style="background-color: white;">&gt;&nbsp;</span><span style="background-color: white;">accepted_hits.plus.bedGraph</span></span><br /><span style="font-family: 'Courier New', Courier, monospace;"><span style="background-color: white;">bedtools genomecov&nbsp;-ibam&nbsp;-bg -split&nbsp;-strand -&nbsp;</span><span style="background-color: white;">-i accepted_hits.bam -g&nbsp;</span><span style="background-color: white;">ChromInfo.txt&nbsp;</span><span style="background-color: white;">&gt;&nbsp;</span><span style="background-color: white;">accepted_hits.minus.bedGraph</span></span><br /><div><span style="font-family: 'Courier New', Courier, monospace;"><br /></span></div><div><div><span style="font-family: 'Courier New', Courier, monospace;">bedGraphToBigWig&nbsp;accepted_hits.plus.bedGraph ChromInfo.txt&nbsp;accepted_hits.plus.bw</span></div><div><span style="font-family: 'Courier New', Courier, monospace;">bedGraphToBigWig&nbsp;accepted_hits.minus.bedGraph ChromInfo.txt&nbsp;accepted_hits.minus.bw</span></div></div></div></div></div><br />