---
layout: post
title: split a file at specific line
date: '2012-05-09T12:40:00.001-04:00'
author: Xianjun Dong
tags:
- awk
- file extraction
modified_time: '2012-05-09T14:37:53.569-04:00'
blogger_id: tag:blogger.com,1999:blog-12445049.post-6208778442376153958
blogger_orig_url: http://onetipperday.blogspot.com/2012/05/split-file-at-specific-line.html
---

I was facing a task: extracting the FASTA sequence from a GFF (or GFF3) file. Well, I just noticed there is a Bio::Perl script for that (http://www.bioperl.org/wiki/Getting_Fasta_sequences_from_a_GFF). But why not using a simple bash/awk for that? I like one-line coding :)<br /><br />Here it is:<br /><pre class="alt2" style="background-attachment: initial; background-clip: initial; background-color: #e1e4f2; background-image: initial; background-origin: initial; border-bottom-style: inset; border-bottom-width: 1px; border-color: initial; border-image: initial; border-left-style: inset; border-left-width: 1px; border-right-style: inset; border-right-width: 1px; border-top-style: inset; border-top-width: 1px; font-size: 13px; overflow-x: auto; overflow-y: auto; padding-bottom: 6px; padding-left: 6px; padding-right: 6px; padding-top: 6px;"><span style="background-color: transparent;">awk '/^&gt;/,/############/' scaffold.gff</span></pre><br />the grammer is awk '/from/, /to/' filename, to get lines from the one containing "from" to the line containing "to". &nbsp;From my tests, I did not get very clear when there are multiple "from" and/or "to". So, be careful!<br /><br />Another option is:<br /><pre class="alt2" style="background-attachment: initial; background-clip: initial; background-color: #e1e4f2; background-image: initial; background-origin: initial; border-bottom-style: inset; border-bottom-width: 1px; border-color: initial; border-image: initial; border-left-style: inset; border-left-width: 1px; border-right-style: inset; border-right-width: 1px; border-top-style: inset; border-top-width: 1px; font-size: 13px; overflow-x: auto; overflow-y: auto; padding-bottom: 6px; padding-left: 6px; padding-right: 6px; padding-top: 6px;">awk '/^&gt;/ {p=1}; p==1 {print}' <span style="background-color: transparent; font-size: 13px;">scaffold.gff</span></pre><br />So, the final code for catenate all extracted fasta sequences is:<br /><br /><pre class="alt2" style="background-attachment: initial; background-clip: initial; background-color: #e1e4f2; background-image: initial; background-origin: initial; border-bottom-style: inset; border-bottom-width: 1px; border-color: initial; border-image: initial; border-left-style: inset; border-left-width: 1px; border-right-style: inset; border-right-width: 1px; border-top-style: inset; border-top-width: 1px; font-size: 13px; overflow-x: auto; overflow-y: auto; padding-bottom: 6px; padding-left: 6px; padding-right: 6px; padding-top: 6px;"><span style="background-color: transparent;">find -name scaffold\*.gff -exec sh -c "awk '/^&gt;/ {p=1}; p==1 {print}' {} &gt;&gt; Manduca_gff_files_version_1.scaffold.fa" \; &amp;</span></pre><div><br /></div>If you care the order of output, e.g. scaffold0001,&nbsp;scaffold0002,&nbsp;scaffold0003, ...&nbsp;then you have to sort the result of find (because find does not sort) first:<div><pre class="alt2" style="background-attachment: initial; background-clip: initial; background-color: #e1e4f2; background-image: initial; background-origin: initial; border-bottom-style: inset; border-bottom-width: 1px; border-color: initial; border-image: initial; border-left-style: inset; border-left-width: 1px; border-right-style: inset; border-right-width: 1px; border-top-style: inset; border-top-width: 1px; font-size: 13px; overflow-x: auto; overflow-y: auto; padding-bottom: 6px; padding-left: 6px; padding-right: 6px; padding-top: 6px;"><span style="background-color: transparent;">for i in `find -name scaffold\*.gff | sort`; do awk '/^&gt;/ {p=1}; p==1 {print}' $i &gt;&gt; Manduca_gff_files_version_1.scaffold.fa; done</span></pre><div><br /></div>References:<br /><ol><li>http://www.unix.com/shell-programming-scripting/6959-split-file-specified-string.html</li><li>http://www.bioperl.org/wiki/Getting_Fasta_sequences_from_a_GFF</li></ol><br /><br /></div>