---
layout: post
title: Access Google Spreadsheet directly in bash and in R
date: '2014-01-31T14:40:00.001-05:00'
author: Xianjun Dong
tags:
- Google Spreadsheet
- R
modified_time: '2015-11-20T10:04:10.141-05:00'
thumbnail: http://1.bp.blogspot.com/-prUB3ks67TA/Uu6ujrLP_eI/AAAAAAAAAo4/1p3chvDw6lQ/s72-c/Screen+Shot+2014-02-02+at+3.45.46+PM.png
blogger_id: tag:blogger.com,1999:blog-12445049.post-3381435666473838053
blogger_orig_url: http://onetipperday.blogspot.com/2014/01/access-google-spreadsheet-directly-in.html
---

Google Doc is a good way to share/manage documents between you and your colleagues, but sometime you want to directly access the data in terminal (e.g. bash) or in program (e.g.  R), without downloading the data first. <br /><br />For example, I have a Google Spreadsheet here:<br /><br /><a href="https://docs.google.com/spreadsheet/pub?key=0Aumm3V3g3dF7dFR6eWRJQjE0UHJpdU8yVTlxb2hUMFE">https://docs.google.com/spreadsheet/pub?key=0Aumm3V3g3dF7dFR6eWRJQjE0UHJpdU8yVTlxb2hUMFE</a><br /><br />I want to open it in R or select some of columns in bash. Here are the tips for that:<br /><br /><b>Step1</b>: publish the tab you want to access to the web [<a href="https://support.google.com/drive/answer/37579?hl=en&amp;ref_topic=2818999">howto</a>], in format of CVS or TXT (which is a tab-delimited file actually)<br /><div class="separator" style="clear: both; text-align: left;"><a href="http://1.bp.blogspot.com/-prUB3ks67TA/Uu6ujrLP_eI/AAAAAAAAAo4/1p3chvDw6lQ/s1600/Screen+Shot+2014-02-02+at+3.45.46+PM.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="433" src="http://1.bp.blogspot.com/-prUB3ks67TA/Uu6ujrLP_eI/AAAAAAAAAo4/1p3chvDw6lQ/s1600/Screen+Shot+2014-02-02+at+3.45.46+PM.png" width="640" /></a></div><div class="separator" style="clear: both; text-align: left;"><br /></div><b>Step2</b>: copy the published URL. At the end, you will see "<span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace;">&amp;output=txt</span>" part for output format, and "<span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace;">&amp;gid=0</span>" to indicate which tab to access (if you have multiple tab, specify tab number here, which starts from 0).<br /><br /><b>Step3</b>: To access the file externally. Done. <br /><br />For example, to access the 1st and 3rd columns in bash:<br /><br /><span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace;">wget --no-check-certificate -q -O - '</span><span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace;">https://docs.google.com/spreadsheet/pub?key=0Aumm3V3g3dF7dFR6eWRJQjE0UHJpdU8yVTlxb2hUMFE&amp;single=true&amp;gid=0&amp;output=txt' | cut -f1,3</span><br /><span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace;"><br /></span>or<span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace;"><br /></span><span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace;">curl -s&nbsp;</span><span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace;">'</span><span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace;">https://docs.google.com/spreadsheet/pub?key=0Aumm3V3g3dF7dFR6eWRJQjE0UHJpdU8yVTlxb2hUMFE&amp;single=true&amp;gid=0&amp;output=txt'</span><br /><span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace;"><br /></span>Note: the quote on the URL is a must.<br />In R, <br /><br /><span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace;">covarianceTableURL="</span><span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace;">https://docs.google.com/spreadsheet/pub?key=0Aumm3V3g3dF7dFR6eWRJQjE0UHJpdU8yVTlxb2hUMFE&amp;single=true&amp;gid=0&amp;output=txt"</span><br /><span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace;">require(RCurl)<br />covarianceTable=read.table(textConnection(getURL(covarianceTableURL)), header=T)</span>