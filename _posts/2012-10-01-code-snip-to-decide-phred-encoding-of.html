---
layout: post
title: code snip to decide Phred encoding of FASTQ file
date: '2012-10-01T23:04:00.002-04:00'
author: Xianjun Dong
tags:
- ASCII
- FASTQ
- format converter
modified_time: '2014-02-20T15:23:25.705-05:00'
blogger_id: tag:blogger.com,1999:blog-12445049.post-7208105990835574914
blogger_orig_url: http://onetipperday.blogspot.com/2012/10/code-snip-to-decide-phred-encoding-of.html
---

It's a common task to check the <a href="http://en.wikipedia.org/wiki/FASTQ_format#Encoding" target="_blank">Phred quality score</a> encoding of fastq file. Sure, it's fairly easy to check this by eyes (according to the rul below), and also there might be already some tools for that purpose. &nbsp;The task is essentially a problem of converting ASCII character into its decimal format.<br /><br /><br /><pre style="background-color: #f9f9f9; border: 1px dashed rgb(47, 111, 171); font-family: monospace, Courier; font-size: 12.666666984558105px; line-height: 1.3em; padding: 1em;">  SSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSS.....................................................<br />  ..........................XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX......................<br />  ...............................IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII......................<br />  .................................<b>J</b>JJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJ......................<br />  LLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLL....................................................<br />  !"#$%&amp;'()*+,-./0123456789:;&lt;=&gt;?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\]^_`abcdefghijklmnopqrstuvwxyz{|}~<br />  |                         |    |        |                              |                     |<br /> 33                        59   64       73                            104                   126<br /><br /> S - Sanger        Phred+33,  raw reads typically (0, 40)<br /> X - Solexa        Solexa+64, raw reads typically (-5, 40)<br /> I - Illumina 1.3+ Phred+64,  raw reads typically (0, 40)<br /> J - Illumina 1.5+ Phred+64,  raw reads typically (3, 40)<br />    with 0=unused, 1=unused, 2=Read Segment Quality Control Indicator (bold) <br />    (Note: See discussion above).<br /> L - Illumina 1.8+ Phred+33,  raw reads typically (0, 41)</pre><br /><br />To be simple, I just wrote a line of code for that, by only looking the first lines of reads. Here it is:<br /><br /><span style="font-family: Courier New, Courier, monospace;">head input.fastq | awk '{if(NR%4==0) printf("%s",$0);}' | &nbsp;od -A n -t u1 | awk 'BEGIN{min=100;max=0;}{for(i=1;i&lt;=NF;i++) {if($i&gt;max) max=$i; if($i&lt;min) min=$i;}}END{if(max&lt;=74 &amp;&amp; min&lt;59) print "Phred+33"; else if(max&gt;73 &amp;&amp; min&gt;=64) print "Phred+64"; else if(min&gt;=59 &amp;&amp; min&lt;64 &amp;&amp; max&gt;73) print "Solexa+64"; else print "Unknown score encoding!";}'</span><br /><br />To use it, you can also save it into a bash, like<br /><br /><span style="font-family: Courier New, Courier, monospace;">#!/bin/sh</span><br /><span style="font-family: Courier New, Courier, monospace;"><br /></span><span style="font-family: Courier New, Courier, monospace;">inputfile=$1</span><br /><span style="font-family: Courier New, Courier, monospace;"><br /></span><span style="font-family: Courier New, Courier, monospace;"># <span style="color: red;"><b>Update</b></span>: The following part for checking the file extension can be&nbsp;simplified (Thanks to the comment from Unknown)&nbsp;</span><br /><strike><span style="font-family: Courier New, Courier, monospace;">[[ "$</span><span style="font-family: 'Courier New', Courier, monospace;">inputfile"</span><span style="font-family: Courier New, Courier, monospace;">&nbsp;=~ ".*\.</span><span style="font-family: 'Courier New', Courier, monospace;">(fq\.gz$|fastq</span><span style="font-family: 'Courier New', Courier, monospace;">\.gz</span><span style="font-family: 'Courier New', Courier, monospace;">$)</span><span style="font-family: Courier New, Courier, monospace;">" ]] &amp;&amp; zcat $</span><span style="font-family: 'Courier New', Courier, monospace;">inputfile</span><span style="font-family: Courier New, Courier, monospace;">&nbsp;|&nbsp;</span><span style="font-family: 'Courier New', Courier, monospace;">head -n40 ...</span></strike><br /><strike><span style="font-family: Courier New, Courier, monospace;">[[&nbsp;</span><span style="font-family: Courier New, Courier, monospace;">"$</span><span style="font-family: 'Courier New', Courier, monospace;">inputfile"</span><span style="font-family: Courier New, Courier, monospace;">&nbsp;=~ ".*\.(fq$|fastq$)"&nbsp;</span><span style="font-family: Courier New, Courier, monospace;">]] &amp;&amp;</span><span style="font-family: Courier New, Courier, monospace;">&nbsp;</span><span style="font-family: 'Courier New', Courier, monospace;">head -n40&nbsp;</span><span style="font-family: Courier New, Courier, monospace;">$</span><span style="font-family: 'Courier New', Courier, monospace;">inputfile</span><span style="font-family: Courier New, Courier, monospace;">&nbsp;</span><span style="font-family: 'Courier New', Courier, monospace;">|</span><span style="font-family: 'Courier New', Courier, monospace;">&nbsp;...</span></strike><br /><span style="font-family: 'Courier New', Courier, monospace;"><br /></span><span style="font-family: 'Courier New', Courier, monospace;">less&nbsp;</span><span style="font-family: Courier New, Courier, monospace;">$</span><span style="font-family: 'Courier New', Courier, monospace;">inputfile | head -n40 |&nbsp;</span><span style="font-family: 'Courier New', Courier, monospace;">awk '{if(NR%4==0) printf("%s",$0);}' | &nbsp;od -A n -t u1 | awk 'BEGIN{min=100;max=0;}{for(i=1;i&lt;=NF;i++) {if($i&gt;max) max=$i; if($i&lt;min) min=$i;}}END{if(max&lt;=74 &amp;&amp; min&lt;59) print "Phred+33"; else if(max&gt;73 &amp;&amp; min&gt;=64) print "Phred+64"; else if(min&gt;=59 &amp;&amp; min&lt;64 &amp;&amp; max&gt;73) print "Solexa+64"; else print "Unknown score encoding!";}'</span><br /><br />The only trick is the command <span style="font-family: Courier New, Courier, monospace;">od,</span> which is to display/convert file content in a specific format. Here is the more detail for od (http://publib.boulder.ibm.com/infocenter/pseries/v5r3/index.jsp?topic=/com.ibm.aix.cmds/doc/aixcmds4/od.htm). <br /><br />