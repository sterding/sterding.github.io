---
layout: post
title: 'data transformation: variance-stabilizing transformation'
date: '2012-05-02T12:15:00.000-04:00'
author: Xianjun Dong
tags:
- Poisson distribution
- variance-stabilizing transformation
- statistics
- Gaussian distribution
- data transformation
- homoskedasticity
modified_time: '2012-05-02T13:47:05.482-04:00'
blogger_id: tag:blogger.com,1999:blog-12445049.post-6993161557576656927
blogger_orig_url: http://onetipperday.blogspot.com/2012/05/data-transformation-variance.html
---

Feeling good to read this <a href="http://en.wikipedia.org/wiki/Variance-stabilizing_transformation">wiki</a>&nbsp;article in the morning, now I understand a bit more why we usually use logarithm (e.g. log2(x)) to transform the data before we do regression. <br /><br />The reason to do variance-stabilizing transformation is to limit/remove the relationship between mean and variance. One of very important assumptions of linear regression is the constant variance (also know as homoskedasticity), see the <a href="http://en.wikipedia.org/wiki/Linear_regression#Assumptions">Assumptions section</a> of Linear regression wiki (http://en.wikipedia.org/wiki/Linear_regression#Assumptions). Violation of the assumption will lead to "less precise parameter estimates and misleading inferential quantities such as standard errors" (from wiki). I've not fully understood this part yet. But nevertheless, wiki article has pointed out several ways to fix the problem, among which is variance-stabilizing transformation (VST), e.g. logarithm. I'd like to try the other way, such as Bayesian linear regression, in future study. <br /><div><br /></div><div>OK. Another key question is: how to choose a proper VST?</div><div><br /></div><div>Here is a very nice one-page math:&nbsp;http://www.stat.ufl.edu/~winner/sta6207/transform.pdf</div><div><br /></div><div>To be simple, if variance of X is function of mean, V(X)=g(u), where u is mean of variable X (e.g. u=E(X)), then the proper VST is:</div><div class="separator" style="clear: both; text-align: center;"><a href="http://upload.wikimedia.org/wikipedia/en/math/3/4/5/345d5f766f42b9c0332b9ac403f1f663.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://upload.wikimedia.org/wikipedia/en/math/3/4/5/345d5f766f42b9c0332b9ac403f1f663.png" /></a></div><div>For example, the Anscombe transform is to transform Poisson distribution (where u=v) to Gaussian distribution:<br /><div class="separator" style="clear: both; text-align: center;"><a href="http://upload.wikimedia.org/wikipedia/en/math/e/3/b/e3b04a04750f5fb22a767af8b88e1c81.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://upload.wikimedia.org/wikipedia/en/math/e/3/b/e3b04a04750f5fb22a767af8b88e1c81.png" /></a></div><br />If V(X)=g(u)=u^2, then the integration of 1/x is log(x).&nbsp;</div><div class="separator" style="clear: both; text-align: center;"><a href="http://upload.wikimedia.org/wikipedia/en/math/2/6/5/265cc9a089e9dec7c36a9c65cbaf9e29.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://upload.wikimedia.org/wikipedia/en/math/2/6/5/265cc9a089e9dec7c36a9c65cbaf9e29.png" /></a></div><div>That's what we usually used for microarray, RNAseq transformation. But do we test the V(X)=u^2 relationship?</div><div><br /></div>We can test the homoskedasticity of residual by  <a href="http://en.wikipedia.org/wiki/Breusch%E2%80%93Pagan_test">Breuschâ€“Pagan test</a>.&nbsp;<span style="background-color: white;"><span style="font-family: 'Courier New', Courier, monospace;">bptest {lmtest}</span> is the R function. Here is the example output:</span><br /><div><blockquote><span style="font-family: 'Courier New', Courier, monospace;">&gt; library('lmtest')<br />&gt; ## generate a regressor<br />&gt; x &lt;- rep(c(-1,1), 50)<br />&gt; ## generate heteroskedastic and homoskedastic disturbances<br />&gt; err1 &lt;- rnorm(100, sd=rep(c(1,2), 50))<br />&gt; err2 &lt;- rnorm(100)<br />&gt; ## generate a linear relationship<br />&gt; y1 &lt;- 1 + x + err1<br />&gt; y2 &lt;- 1 + x + err2<br />&gt; ## perform Breusch-Pagan test<br />&gt; bptest(y1 ~ x)<br /><span class="Apple-tab-span" style="white-space: pre;"> </span>studentized Breusch-Pagan test<br />data: &nbsp;y1 ~ x<br />BP = 15.867, df = 1, p-value = <span style="color: red;">6.795e-05</span><br />&gt; bptest(y2 ~ x)<br /><span class="Apple-tab-span" style="white-space: pre;"> </span>studentized Breusch-Pagan test<br />data: &nbsp;y2 ~ x<br />BP = 7e-04, df = 1, p-value = 0.9784</span></blockquote><div><br /></div><div>y1 is significantly heteroskedastic, because the p-value is &lt;0.05.</div><div><br /></div></div>