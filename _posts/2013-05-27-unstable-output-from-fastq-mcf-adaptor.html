---
layout: post
title: Unstable output from fastq-mcf (adaptor removal)
date: '2013-05-27T01:24:00.000-04:00'
author: Xianjun Dong
tags:
- adaptor
- next-generation sequencing
modified_time: '2013-05-30T00:09:57.923-04:00'
blogger_id: tag:blogger.com,1999:blog-12445049.post-6569646492625018954
blogger_orig_url: http://onetipperday.blogspot.com/2013/05/unstable-output-from-fastq-mcf-adaptor.html
---

<div class="gmail_default" style="background-color: white; color: #000099; font-family: arial, sans-serif; font-size: 13px;">Below is what I wrote to the author regarding the problem I just found. Erik suggested to use "-t 0" to fix the problem (see info at the end)</div><div class="gmail_default" style="background-color: white; color: #000099; font-family: arial, sans-serif; font-size: 13px;"><br /></div><div class="gmail_default" style="background-color: white; color: #000099; font-family: arial, sans-serif; font-size: 13px;">================</div><div class="gmail_default" style="background-color: white; color: #000099; font-family: arial, sans-serif; font-size: 13px;"><br /></div><div class="gmail_default" style="background-color: white; color: #222222; font-family: arial, sans-serif; font-size: 13px;"><span style="color: #000099;">I am really frustrated with a problem I am facing while using the fastq-mcf for&nbsp;adaptor&nbsp;removal -- the same read in different files with different number of reads will get different trimming result. WHAT'S THE PROBLEM?</span></div><div class="gmail_default" style="background-color: white; color: #222222; font-family: arial, sans-serif; font-size: 13px;"><span style="color: #000099;"><br /></span></div><div class="gmail_default" style="background-color: white; color: #222222; font-family: arial, sans-serif; font-size: 13px;"><span style="color: #000099;">Here is the test example:</span></div><div class="gmail_default" style="background-color: white; color: #222222; font-family: arial, sans-serif; font-size: 13px;"><span style="color: #000099;"><br /></span></div><div class="gmail_default" style="background-color: white; color: #222222; font-family: arial, sans-serif; font-size: 13px;"><span style="color: #000099;">adaptor:</span></div><div class="gmail_default" style="background-color: white; color: #222222; font-family: arial, sans-serif; font-size: 13px;"><span style="color: #000099;"></span><br /><div class="gmail_default"><span style="color: #000099;">$ cat adaptor.fa&nbsp;</span></div><span style="color: #000099;"><div class="gmail_default">&gt;adapter1</div><div class="gmail_default">CAAGCAGAAGACGGCATACGAGATTCAAGT<wbr></wbr>GTGACTGGAGTTCCTTGGCACCCGAGAATT<wbr></wbr>CCA</div><div class="gmail_default">&gt;RC_adapter1</div><div class="gmail_default">TGGAATTCTCGGGTGCCAAGGAACTCCAGT<wbr></wbr>CACACTTGAATCTCGTATGCCGTCTTCTGC<wbr></wbr>TTG</div><div class="gmail_default"><br /></div><div class="gmail_default"><div class="gmail_default">Input file:</div><div class="gmail_default">$ head test.fa</div><div class="gmail_default">@HWI-ST560:107:D25EJACXX:3:<wbr></wbr>1301:11693:29455 1:N:0:GCCTAA</div><div class="gmail_default">CAGTGCAATGTTAAAAGGGCATTTGGAATT<wbr></wbr>CTCGGGTGCCAAGGAACTCC</div><div class="gmail_default">+</div><div class="gmail_default">CCCDFFFFHHHHGJJJJJJJJJJJJJJJJJ<wbr></wbr>JJJJJIHHJJIJJJIJJIIJ</div><div class="gmail_default">@HWI-ST560:107:D25EJACXX:3:<wbr></wbr>1101:1420:1954 1:N:0:TTAGGC</div><div class="gmail_default">ATACAGTCCGACGATCTGGAATTCTCGGGT<wbr></wbr>GCCAAGGAACTCCAGTCACT</div><div class="gmail_default">+</div><div class="gmail_default">@@@DDDDDHHG?<wbr></wbr>FDGIIBEHAFGIIHFHIHGIIEHGGGHFHI<wbr></wbr>IGGGGGHI</div><div class="gmail_default"><br /></div><div class="gmail_default">When I include different number of reads, the result are differnt for the 1st read:</div><div class="gmail_default"><br /></div><div class="gmail_default">$ head -n10000 test.fa &gt; test1.fq; ~/bin/ea-utils.1.1.2-537/<wbr></wbr>fastq-mcf -o test1.out -l 16 -q 15 -w 4 -x 20 -u -S -P 33 adaptor.fa test1.fq; head test1.out</div><div class="gmail_default"><br /></div><div class="gmail_default"><div class="gmail_default">@HWI-ST560:107:D25EJACXX:3:<wbr></wbr>1301:11693:29455 1:N:0:GCCTAA</div><div class="gmail_default">CAGTGCAATGTTAAAAGGGCATT<b style="background-color: yellow;">TGGAATT<wbr></wbr>CTCGGGTGCCAAGGAACTCC</b></div><div class="gmail_default">+</div><div class="gmail_default">CCCDFFFFHHHHGJJJJJJJJJJJJJJJJJ<wbr></wbr>JJJJJIHHJJIJJJIJJIIJ</div><div class="gmail_default"><br /></div><div class="gmail_default">This is not correct, as the yellow highlight part is from RC_adapter1 obviously.&nbsp;</div><div class="gmail_default"><br /></div><div class="gmail_default">But if I set a smaller number of sample, it will be correct. See below for "head -n100":</div><div class="gmail_default"><br /></div><div class="gmail_default"><div class="gmail_default">$ head -n100 test.fa &gt; test1.fq; ~/bin/ea-utils.1.1.2-537/<wbr></wbr>fastq-mcf -o test1.out -l 16 -q 15 -w 4 -x 20 -u -S -P 33 adaptor.fa test1.fq; head test1.out</div><div><br /></div><div><div>@HWI-ST560:107:D25EJACXX:3:<wbr></wbr>1301:11693:29455 1:N:0:GCCTAA</div><div>CAGTGCAATGTTAAAAGGGCATT</div><div>+</div><div>CCCDFFFFHHHHGJJJJJJJJJJ</div></div><div><br /></div><div>And if I set "-C 0", it will get correct result as well (even for a larger number of sample):</div><div><br /></div><div><div>$ head -n10000 test.fa &gt; test1.fq; ~/bin/ea-utils.1.1.2-537/<wbr></wbr>fastq-mcf -o test1.out -l 16 -q 15 -w 4 -x 20 -u -S -P 33 -C 0 adaptor.fa test1.fq; head test1.out</div><div><br /></div><div><div>@HWI-ST560:107:D25EJACXX:3:<wbr></wbr>1301:11693:29455 1:N:0:GCCTAA</div><div>CAGTGCAATGTTAAAAGGGCATT</div><div>+</div><div>CCCDFFFFHHHHGJJJJJJJJJJ</div></div><div><br /></div><div>This is very confusing! Please help me on it.<br /><br />=========== reply from Erik========<br /><span style="color: #222222;">fastq-mcf will not bother to clip if the adaptor is rare (&lt; .25% presence in sampling). &nbsp; The reason is that the dangers of clipping (removing valid sequence) can outweigh the benefits (removing invalid sequence) as the number of adaptor sequences get fewer and fewer.</span><br /><div style="color: #222222;"><br /></div><div style="color: #222222;">To override this, you set -t 0 (always clip everything)</div></div></div></div></div></div></span></div>