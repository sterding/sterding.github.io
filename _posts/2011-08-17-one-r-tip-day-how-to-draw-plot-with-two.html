---
layout: post
title: 'One R Tip A Day: How to draw a plot with two Y axises and one X axis'
date: '2011-08-17T14:22:00.000-04:00'
author: Xianjun
tags:
- R
modified_time: '2011-08-18T10:08:38.792-04:00'
thumbnail: http://4.bp.blogspot.com/_zct02J1FROM/R0Kh9q5Va_I/AAAAAAAAAFI/xYpEHLTQvVM/s72-c/usr.png
blogger_id: tag:blogger.com,1999:blog-12445049.post-4547938574934699920
blogger_orig_url: http://onetipperday.blogspot.com/2011/08/one-r-tip-day-how-to-draw-plot-with-two.html
---

<div dir="ltr" style="text-align: left;" trbidi="on"><a href="http://onertipaday.blogspot.com/2007/05/how-to-draw-plot-with-two-y-axises-and.html">One R Tip A Day: How to draw a plot with two Y axises and one X axis</a><br /><blockquote><span class="Apple-style-span" style="font-family: 'Courier New', Courier, monospace;">plot(1:10)<br />par("usr")<br /># [1] 0.64 10.36 0.64 10.36<br /># Now resetting y axis' usr coordinates:<br />par(usr=c(par("usr")[1:2], 101, 105))<br />points(1:5, 105:101, col="red")<br />axis(4)</span></blockquote><img alt="" border="0" id="BLOGGER_PHOTO_ID_5134844606014647282" src="http://4.bp.blogspot.com/_zct02J1FROM/R0Kh9q5Va_I/AAAAAAAAAFI/xYpEHLTQvVM/s400/usr.png" style="display: block; margin-bottom: 10px; margin-left: auto; margin-right: auto; margin-top: 0px; text-align: center;" /><br /><br /><span class="Apple-style-span" style="font-family: 'Courier New', Courier, monospace; font-size: x-small;"></span><br /><span class="Apple-style-span" style="font-family: 'Courier New', Courier, monospace;">par(mar=c(4, 5, 4, 5) + 0.1)</span><br /><span class="Apple-style-span" style="font-family: 'Courier New', Courier, monospace;">plot(y1, type='b', col='gray', ylim=range(c(y1, y2)), ylab="y")</span><br /><span class="Apple-style-span" style="font-family: 'Courier New', Courier, monospace;">lines(y2, type='b', pch=19)</span><br /><span class="Apple-style-span" style="font-family: 'Courier New', Courier, monospace;"># draw the other Y axis&nbsp;</span><br /><span class="Apple-style-span" style="font-family: 'Courier New', Courier, monospace;">par(usr=c(par("usr")[1:2], range(Y)))</span><br /><span class="Apple-style-span" style="font-family: 'Courier New', Courier, monospace;">lines(Y, type='b', pch=20, col='blue')</span><br /><span class="Apple-style-span" style="font-family: 'Courier New', Courier, monospace;">axis(4, col.axis='blue')</span><br /><span class="Apple-style-span" style="font-family: 'Courier New', Courier, monospace;"># manually label the other Y axis</span><br /><span class="Apple-style-span" style="font-family: 'Courier New', Courier, monospace;">mtext(side=4, line=1, 'Y', col='blue')</span><br /><span class="Apple-style-span" style="font-family: 'Courier New', Courier, monospace;">legend('topleft', c("y1", "y2", "Y"), pch=c(19, 1, 20), col=c('black', 'gray', 'blue'), lty=1)</span><br /><br /><div>A very smart way, rather than transforming one Y axis range to the other Y axis range by math formula.<br /><span class="Apple-style-span" style="font-family: 'Courier New', Courier, monospace; font-size: x-small;"><br /></span><br /><span class="Apple-style-span" style="font-family: 'Courier New', Courier, monospace;">#Y = (Y-min(Y))*(max(y1, y2) - min(y1, y2))/(max(Y)-min(Y)) + min(y1, y2)</span></div><div></div></div>