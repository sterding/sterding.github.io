---
layout: post
title: samtools tview only show alignments with non-* QUAL field
date: '2013-01-14T13:17:00.001-05:00'
author: Xianjun Dong
tags:
- samtools
modified_time: '2013-01-14T13:21:32.289-05:00'
blogger_id: tag:blogger.com,1999:blog-12445049.post-3418161255225746310
blogger_orig_url: http://onetipperday.blogspot.com/2013/01/samtools-tview-only-show-alignments.html
---

If your input file is fasta (or fastq without quality score), then your alignment from Tophat or Bowtie2 will generate SAM like:<br /><br /><br />$ samtools view alignment.bam &nbsp;| fgrep -wi T0730373<br />t0730373<span class="Apple-tab-span" style="white-space: pre;"> </span>256<span class="Apple-tab-span" style="white-space: pre;"> </span>scaffold00006<span class="Apple-tab-span" style="white-space: pre;"> </span>1146736<span class="Apple-tab-span" style="white-space: pre;"> </span>0<span class="Apple-tab-span" style="white-space: pre;"> </span>27M<span class="Apple-tab-span" style="white-space: pre;"> </span>*<span class="Apple-tab-span" style="white-space: pre;"> </span>0<span class="Apple-tab-span" style="white-space: pre;"> </span>0<span class="Apple-tab-span" style="white-space: pre;"> </span>ACTGGGAACACCGCGTGATGTTGGCTA<span class="Apple-tab-span" style="white-space: pre;"> </span>*<span class="Apple-tab-span" style="white-space: pre;"> </span>AS:i:-12<span class="Apple-tab-span" style="white-space: pre;"> </span>XS:i:-12<span class="Apple-tab-span" style="white-space: pre;"> </span>XN:i:0<span class="Apple-tab-span" style="white-space: pre;"> </span>XM:i:2<span class="Apple-tab-span" style="white-space: pre;"> </span>XO:i:0XG:i:0<span class="Apple-tab-span" style="white-space: pre;"> </span>NM:i:2<span class="Apple-tab-span" style="white-space: pre;"> </span>MD:Z:0C25T0<span class="Apple-tab-span" style="white-space: pre;"> </span>YT:Z:UU<br />t0730373<span class="Apple-tab-span" style="white-space: pre;"> </span>272<span class="Apple-tab-span" style="white-space: pre;"> </span>scaffold00006<span class="Apple-tab-span" style="white-space: pre;"> </span>1351262<span class="Apple-tab-span" style="white-space: pre;"> </span>0<span class="Apple-tab-span" style="white-space: pre;"> </span>27M<span class="Apple-tab-span" style="white-space: pre;"> </span>*<span class="Apple-tab-span" style="white-space: pre;"> </span>0<span class="Apple-tab-span" style="white-space: pre;"> </span>0<span class="Apple-tab-span" style="white-space: pre;"> </span>TAGCCAACATCACGCGGTGTTCCCAGT<span class="Apple-tab-span" style="white-space: pre;"> </span>*<span class="Apple-tab-span" style="white-space: pre;"> </span>AS:i:-12<span class="Apple-tab-span" style="white-space: pre;"> </span>XS:i:-12<span class="Apple-tab-span" style="white-space: pre;"> </span>XN:i:0<span class="Apple-tab-span" style="white-space: pre;"> </span>XM:i:2<span class="Apple-tab-span" style="white-space: pre;"> </span>XO:i:0XG:i:0<span class="Apple-tab-span" style="white-space: pre;"> </span>NM:i:2<span class="Apple-tab-span" style="white-space: pre;"> </span>MD:Z:0A25G0<span class="Apple-tab-span" style="white-space: pre;"> </span>YT:Z:UU<br />t0730373<span class="Apple-tab-span" style="white-space: pre;"> </span>0<span class="Apple-tab-span" style="white-space: pre;"> </span>scaffold00006<span class="Apple-tab-span" style="white-space: pre;"> </span>1460535<span class="Apple-tab-span" style="white-space: pre;"> </span>0<span class="Apple-tab-span" style="white-space: pre;"> </span>27M<span class="Apple-tab-span" style="white-space: pre;"> </span>*<span class="Apple-tab-span" style="white-space: pre;"> </span>0<span class="Apple-tab-span" style="white-space: pre;"> </span>0<span class="Apple-tab-span" style="white-space: pre;"> </span>ACTGGGAACACCGCGTGATGTTGGCTA<span class="Apple-tab-span" style="white-space: pre;"> </span>IIIIIIIIIIIIIIIIIIIIIIIIIII<span class="Apple-tab-span" style="white-space: pre;"> </span>AS:i:-12<span class="Apple-tab-span" style="white-space: pre;"> </span>XS:i:-12<span class="Apple-tab-span" style="white-space: pre;"> </span>XN:i:0<span class="Apple-tab-span" style="white-space: pre;"> </span>XM:i:2<span class="Apple-tab-span" style="white-space: pre;"> </span>XO:i:0<span class="Apple-tab-span" style="white-space: pre;"> </span>XG:i:0<span class="Apple-tab-span" style="white-space: pre;"> </span>NM:i:2<span class="Apple-tab-span" style="white-space: pre;"> </span>MD:Z:0C25T0<span class="Apple-tab-span" style="white-space: pre;"> </span>YT:Z:UU<br />t0730373<span class="Apple-tab-span" style="white-space: pre;"> </span>256<span class="Apple-tab-span" style="white-space: pre;"> </span>scaffold00144<span class="Apple-tab-span" style="white-space: pre;"> </span>669608<span class="Apple-tab-span" style="white-space: pre;"> </span>0<span class="Apple-tab-span" style="white-space: pre;"> </span>27M<span class="Apple-tab-span" style="white-space: pre;"> </span>*<span class="Apple-tab-span" style="white-space: pre;"> </span>0<span class="Apple-tab-span" style="white-space: pre;"> </span>0<span class="Apple-tab-span" style="white-space: pre;"> </span>ACTGGGAACACCGCGTGATGTTGGCTA<span class="Apple-tab-span" style="white-space: pre;"> </span>*<span class="Apple-tab-span" style="white-space: pre;"> </span>AS:i:-12<span class="Apple-tab-span" style="white-space: pre;"> </span>XS:i:-12<span class="Apple-tab-span" style="white-space: pre;"> </span>XN:i:0<span class="Apple-tab-span" style="white-space: pre;"> </span>XM:i:2<span class="Apple-tab-span" style="white-space: pre;"> </span>XO:i:0XG:i:0<span class="Apple-tab-span" style="white-space: pre;"> </span>NM:i:2<span class="Apple-tab-span" style="white-space: pre;"> </span>MD:Z:0C25T0<span class="Apple-tab-span" style="white-space: pre;"> </span>YT:Z:UU<br />t0730373<span class="Apple-tab-span" style="white-space: pre;"> </span>256<span class="Apple-tab-span" style="white-space: pre;"> </span>scaffold00550<span class="Apple-tab-span" style="white-space: pre;"> </span>85141<span class="Apple-tab-span" style="white-space: pre;"> </span>0<span class="Apple-tab-span" style="white-space: pre;"> </span>27M<span class="Apple-tab-span" style="white-space: pre;"> </span>*<span class="Apple-tab-span" style="white-space: pre;"> </span>0<span class="Apple-tab-span" style="white-space: pre;"> </span>0<span class="Apple-tab-span" style="white-space: pre;"> </span>ACTGGGAACACCGCGTGATGTTGGCTA<span class="Apple-tab-span" style="white-space: pre;"> </span>*<span class="Apple-tab-span" style="white-space: pre;"> </span>AS:i:-12<span class="Apple-tab-span" style="white-space: pre;"> </span>XS:i:-12<span class="Apple-tab-span" style="white-space: pre;"> </span>XN:i:0<span class="Apple-tab-span" style="white-space: pre;"> </span>XM:i:2<span class="Apple-tab-span" style="white-space: pre;"> </span>XO:i:0XG:i:0<span class="Apple-tab-span" style="white-space: pre;"> </span>NM:i:2<span class="Apple-tab-span" style="white-space: pre;"> </span>MD:Z:0C25T0<span class="Apple-tab-span" style="white-space: pre;"> </span>YT:Z:UU<br /><br />You see that only the first alignment has the QUAL field, the other secondary alignments have a "*" in the field. And the samtools tview cannot display those alignment. &nbsp;That's the tip!<br /><div><br /></div><div><br /></div><div><br /></div>