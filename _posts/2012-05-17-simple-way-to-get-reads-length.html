---
layout: post
title: simple way to get reads length distribution of FASTQ files
date: '2012-05-17T11:16:00.000-04:00'
author: Xianjun Dong
tags:
- FASTQ
- next-generation sequencing
- linux
- awk
- find
modified_time: '2012-05-17T11:16:13.768-04:00'
blogger_id: tag:blogger.com,1999:blog-12445049.post-213986105091021222
blogger_orig_url: http://onetipperday.blogspot.com/2012/05/simple-way-to-get-reads-length.html
---

<br /><ul><li>Using perl:&nbsp;</li></ul><span style="font-family: 'Courier New', Courier, monospace;">cat input.fq | perl -ne '$s=&lt;&gt;;&lt;&gt;;&lt;&gt;;chomp($s);print length($s)."\n";' &gt; input.readslength.txt</span><ul><li>Using awk:</li></ul><span style="font-family: 'Courier New', Courier, monospace;">cat input.fq |&nbsp;awk '{if(NR%4==2) print length($1)}'&nbsp;&gt; input.readslength.txt</span><ul><li>if zipped file, using:</li></ul><span style="font-family: 'Courier New', Courier, monospace;">&nbsp;zcat input.fq.gz | ...</span><ul><li>get length statistics:</li></ul><span style="font-family: 'Courier New', Courier, monospace;">sort input.readslength.txt | uniq -c</span><br /><br /><ul><li>or using fancy code from <a href="http://hgdownload.cse.ucsc.edu/admin/exe/linux.x86_64/" target="_blank">Jim Kent's utility</a>:</li></ul><span style="font-family: 'Courier New', Courier, monospace;">textHistogram</span><br /><span style="font-family: 'Courier New', Courier, monospace;"><br /></span><br />So, one line code for all input fastq files would be:<br /><br /><span style="font-family: 'Courier New', Courier, monospace;">find *.fq.gz -not -name \*raw\* -printf "zcat %p | awk '{if(NR%%4==2) print length(\$1)}' | textHistogram -maxBinCount=59 stdin \n" | sh</span><br /><span style="font-family: 'Courier New', Courier, monospace;"><br /></span><br />Note that you have to use double % to escape the % character for printf formatting control, just like in C. (Thanks for zencuke's answer  <a href="http://tech.groups.yahoo.com/group/handyboard/message/211">here</a>)<div><br /></div><div>You will get something like this:</div><div><br /></div><div><div style="background-color: rgba(255, 255, 255, 0.917969); color: #222222; font-family: arial, sans-serif; font-size: 13px;">RNAseq.20E_library.result_<wbr></wbr>primary.clean.fa</div><div style="background-color: rgba(255, 255, 255, 0.917969); color: #222222; font-family: arial, sans-serif; font-size: 13px;">large values truncated: need 35 bins or larger binSize than 1</div><div style="background-color: rgba(255, 255, 255, 0.917969); color: #222222; font-family: arial, sans-serif; font-size: 13px;">Maximum value 53.000000</div><div style="background-color: rgba(255, 255, 255, 0.917969); color: #222222; font-family: arial, sans-serif; font-size: 13px;">&nbsp;18 ********* 27730</div><div style="background-color: rgba(255, 255, 255, 0.917969); color: #222222; font-family: arial, sans-serif; font-size: 13px;">&nbsp;19 ******************* 58997</div><div style="background-color: rgba(255, 255, 255, 0.917969); color: #222222; font-family: arial, sans-serif; font-size: 13px;">&nbsp;20 ******************************<wbr></wbr>****************************** 186919</div><div style="background-color: rgba(255, 255, 255, 0.917969); color: #222222; font-family: arial, sans-serif; font-size: 13px;">&nbsp;21 ************************ 74536</div><div style="background-color: rgba(255, 255, 255, 0.917969); color: #222222; font-family: arial, sans-serif; font-size: 13px;">&nbsp;22 ************** 45171</div><div style="background-color: rgba(255, 255, 255, 0.917969); color: #222222; font-family: arial, sans-serif; font-size: 13px;">&nbsp;23 ************* 39107</div><div style="background-color: rgba(255, 255, 255, 0.917969); color: #222222; font-family: arial, sans-serif; font-size: 13px;">&nbsp;24 *************** 45560</div><div style="background-color: rgba(255, 255, 255, 0.917969); color: #222222; font-family: arial, sans-serif; font-size: 13px;">&nbsp;25 *********************** 70452</div><div style="background-color: rgba(255, 255, 255, 0.917969); color: #222222; font-family: arial, sans-serif; font-size: 13px;">&nbsp;26 ******************************<wbr></wbr>******************* 154030</div><div style="background-color: rgba(255, 255, 255, 0.917969); color: #222222; font-family: arial, sans-serif; font-size: 13px;">&nbsp;27 ******************************<wbr></wbr>****************************** 187704</div><div style="background-color: rgba(255, 255, 255, 0.917969); color: #222222; font-family: arial, sans-serif; font-size: 13px;">&nbsp;28 ************************** 81198</div><div style="background-color: rgba(255, 255, 255, 0.917969); color: #222222; font-family: arial, sans-serif; font-size: 13px;">&nbsp;29 ***** 17016</div><div style="background-color: rgba(255, 255, 255, 0.917969); color: #222222; font-family: arial, sans-serif; font-size: 13px;">&nbsp;30 ** 5341</div><div style="background-color: rgba(255, 255, 255, 0.917969); color: #222222; font-family: arial, sans-serif; font-size: 13px;">&nbsp;31 * 2439</div><div style="background-color: rgba(255, 255, 255, 0.917969); color: #222222; font-family: arial, sans-serif; font-size: 13px;">&nbsp;32 &nbsp;0</div><div style="background-color: rgba(255, 255, 255, 0.917969); color: #222222; font-family: arial, sans-serif; font-size: 13px;">&nbsp;33 &nbsp;1</div><div style="background-color: rgba(255, 255, 255, 0.917969); color: #222222; font-family: arial, sans-serif; font-size: 13px;">&nbsp;34 &nbsp;0</div><div style="background-color: rgba(255, 255, 255, 0.917969); color: #222222; font-family: arial, sans-serif; font-size: 13px;">&nbsp;35 &nbsp;0</div><div style="background-color: rgba(255, 255, 255, 0.917969); color: #222222; font-family: arial, sans-serif; font-size: 13px;">&nbsp;36 &nbsp;0</div><div style="background-color: rgba(255, 255, 255, 0.917969); color: #222222; font-family: arial, sans-serif; font-size: 13px;">&nbsp;37 &nbsp;0</div><div style="background-color: rgba(255, 255, 255, 0.917969); color: #222222; font-family: arial, sans-serif; font-size: 13px;">&nbsp;38 &nbsp;0</div><div style="background-color: rgba(255, 255, 255, 0.917969); color: #222222; font-family: arial, sans-serif; font-size: 13px;">&nbsp;39 &nbsp;1</div><div style="background-color: rgba(255, 255, 255, 0.917969); color: #222222; font-family: arial, sans-serif; font-size: 13px;">&lt;minVal or &gt;= 40 &nbsp;173</div><div style="background-color: rgba(255, 255, 255, 0.917969); color: #222222; font-family: arial, sans-serif; font-size: 13px;"><br /></div><div style="background-color: rgba(255, 255, 255, 0.917969); color: #222222; font-family: arial, sans-serif; font-size: 13px;">RNAseq.Day_13_library.result_<wbr></wbr>primary.clean.fa</div><div style="background-color: rgba(255, 255, 255, 0.917969); color: #222222; font-family: arial, sans-serif; font-size: 13px;">large values truncated: need 35 bins or larger binSize than 1</div><div style="background-color: rgba(255, 255, 255, 0.917969); color: #222222; font-family: arial, sans-serif; font-size: 13px;">Maximum value 53.000000</div><div style="background-color: rgba(255, 255, 255, 0.917969); color: #222222; font-family: arial, sans-serif; font-size: 13px;">&nbsp;18 ***** 22570</div><div style="background-color: rgba(255, 255, 255, 0.917969); color: #222222; font-family: arial, sans-serif; font-size: 13px;">&nbsp;19 ********* 40335</div><div style="background-color: rgba(255, 255, 255, 0.917969); color: #222222; font-family: arial, sans-serif; font-size: 13px;">&nbsp;20 ***************************** 127999</div><div style="background-color: rgba(255, 255, 255, 0.917969); color: #222222; font-family: arial, sans-serif; font-size: 13px;">&nbsp;21 ********************* 95179</div><div style="background-color: rgba(255, 255, 255, 0.917969); color: #222222; font-family: arial, sans-serif; font-size: 13px;">&nbsp;22 ****************** 79808</div><div style="background-color: rgba(255, 255, 255, 0.917969); color: #222222; font-family: arial, sans-serif; font-size: 13px;">&nbsp;23 ********* 39596</div><div style="background-color: rgba(255, 255, 255, 0.917969); color: #222222; font-family: arial, sans-serif; font-size: 13px;">&nbsp;24 ******* 29423</div><div style="background-color: rgba(255, 255, 255, 0.917969); color: #222222; font-family: arial, sans-serif; font-size: 13px;">&nbsp;25 ************* 55438</div><div style="background-color: rgba(255, 255, 255, 0.917969); color: #222222; font-family: arial, sans-serif; font-size: 13px;">&nbsp;26 ******************************<wbr></wbr>******* 164868</div><div style="background-color: rgba(255, 255, 255, 0.917969); color: #222222; font-family: arial, sans-serif; font-size: 13px;">&nbsp;27 ******************************<wbr></wbr>****************************** 265722</div><div style="background-color: rgba(255, 255, 255, 0.917969); color: #222222; font-family: arial, sans-serif; font-size: 13px;">&nbsp;28 *************************** 120353</div><div style="background-color: rgba(255, 255, 255, 0.917969); color: #222222; font-family: arial, sans-serif; font-size: 13px;">&nbsp;29 ********* 38625</div><div style="background-color: rgba(255, 255, 255, 0.917969); color: #222222; font-family: arial, sans-serif; font-size: 13px;">&nbsp;30 *** 14684</div><div style="background-color: rgba(255, 255, 255, 0.917969); color: #222222; font-family: arial, sans-serif; font-size: 13px;">&nbsp;31 * 5214</div><div style="background-color: rgba(255, 255, 255, 0.917969); color: #222222; font-family: arial, sans-serif; font-size: 13px;">&nbsp;32 &nbsp;0</div><div style="background-color: rgba(255, 255, 255, 0.917969); color: #222222; font-family: arial, sans-serif; font-size: 13px;">&nbsp;33 &nbsp;0</div><div style="background-color: rgba(255, 255, 255, 0.917969); color: #222222; font-family: arial, sans-serif; font-size: 13px;">&nbsp;34 &nbsp;1</div><div style="background-color: rgba(255, 255, 255, 0.917969); color: #222222; font-family: arial, sans-serif; font-size: 13px;">&lt;minVal or &gt;= 35 &nbsp;140</div></div>