---
layout: post
title: 'reshape: from long to wide format'
date: '2015-02-26T17:38:00.000-05:00'
author: Xianjun Dong
tags:
- reshape
- R
modified_time: '2015-02-26T17:39:49.520-05:00'
thumbnail: http://4.bp.blogspot.com/-NcJUTF166k4/VO-gNfW20YI/AAAAAAAAAyE/pj8cSSleQFw/s72-c/Screen%2BShot%2B2015-02-26%2Bat%2B5.37.08%2BPM.png
blogger_id: tag:blogger.com,1999:blog-12445049.post-562733323125977495
blogger_orig_url: http://onetipperday.blogspot.com/2015/02/reshape-from-long-to-wide-format.html
---

This is to continue on the topic of using the <span style="font-family: Courier New, Courier, monospace;">melt/cast</span> functions in&nbsp;<span style="font-family: Courier New, Courier, monospace;">reshape</span> to convert between long and wide format of data frame. Here is the example I found helpful in generating covariate table required for PEER (or Matrix_eQTL) analysis:<br /><br />Here is my original covariate table:<br /><div class="separator" style="clear: both; text-align: center;"><a href="http://4.bp.blogspot.com/-NcJUTF166k4/VO-gNfW20YI/AAAAAAAAAyE/pj8cSSleQFw/s1600/Screen%2BShot%2B2015-02-26%2Bat%2B5.37.08%2BPM.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://4.bp.blogspot.com/-NcJUTF166k4/VO-gNfW20YI/AAAAAAAAAyE/pj8cSSleQFw/s1600/Screen%2BShot%2B2015-02-26%2Bat%2B5.37.08%2BPM.png" /></a></div><br /><div class="separator" style="clear: both; text-align: center;"></div><div class="separator" style="clear: both; text-align: left;">Let's say we need to convert the categorical variables such as condition, cellType, batch, replicate, readLength, sex into indicators (Note: this is required by most regression programs like <a href="http://www.ncbi.nlm.nih.gov/pmc/articles/PMC3398141/pdf/ukmss-48786.pdf">PEER</a> or Matrix-eQTL, since for example the batch 5 does not match it's higher than batch 1, unlike the age or PMI). So, we need to convert this long format into wide format. Here is my R code for that:</div><div class="separator" style="clear: both; text-align: left;"><br /></div><div class="separator" style="clear: both;"><span style="font-family: Courier New, Courier, monospace;">library(reshape2)</span></div><div class="separator" style="clear: both;"><span style="font-family: Courier New, Courier, monospace;">categorical_varaibles = c("batch", "sex", "readsLength", "condition", "cellType", "replicate");</span></div><div class="separator" style="clear: both;"><span style="font-family: Courier New, Courier, monospace;">for(x in categorical_varaibles) {cvrt = cbind(cvrt, value=1); cvrt[,x]=paste0(x,cvrt[,x]); cvrt = dcast(cvrt, as.formula(paste0("... ~ ", x)), fill=0);}</span></div><div><br /></div>Here is output:<br /><div class="p1"><div class="separator" style="clear: both; text-align: center;"><a href="http://2.bp.blogspot.com/-_2XVYmoTi2U/VO-gpB8304I/AAAAAAAAAyM/KRjhxTHbVlA/s1600/Screen%2BShot%2B2015-02-26%2Bat%2B5.39.07%2BPM.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://2.bp.blogspot.com/-_2XVYmoTi2U/VO-gpB8304I/AAAAAAAAAyM/KRjhxTHbVlA/s1600/Screen%2BShot%2B2015-02-26%2Bat%2B5.39.07%2BPM.png" /></a></div><br /></div>