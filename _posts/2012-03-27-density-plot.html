---
layout: post
title: how to draw density plot in R
date: '2012-03-27T15:55:00.001-04:00'
author: Xianjun Dong
tags:
- hexbin
- density plot
- smoothScatter
modified_time: '2012-03-27T15:57:23.197-04:00'
blogger_id: tag:blogger.com,1999:blog-12445049.post-4028041997025547674
blogger_orig_url: http://onetipperday.blogspot.com/2012/03/density-plot.html
---

<br /><div style="background-color: white; color: #444444; font-family: 'Trebuchet MS', Arial, Helvetica, sans-serif; font-size: 13px; line-height: 1.8em; padding-bottom: 10px; padding-left: 0px; padding-right: 0px; padding-top: 10px; text-align: justify;">When there are many data points and significant overlap, scatterplots become less useful. There are several approaches that be used when this occurs. The&nbsp;<strong style="margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px; padding-bottom: 0px; padding-left: 0px; padding-right: 0px; padding-top: 0px;">hexbin(x, y)&nbsp;</strong>function in the&nbsp;<a href="http://bioconductor.org/packages/2.0/bioc/html/hexbin.html" style="color: #4082b2; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px; padding-bottom: 0px; padding-left: 0px; padding-right: 0px; padding-top: 0px;"><strong style="margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px; padding-bottom: 0px; padding-left: 0px; padding-right: 0px; padding-top: 0px;">hexbin</strong></a>&nbsp;package provides bivariate binning into hexagonal cells (it looks better than it sounds).</div><div style="background-color: white; color: #444444; font-family: 'Trebuchet MS', Arial, Helvetica, sans-serif; font-size: 13px; line-height: 1.8em; padding-bottom: 10px; padding-left: 0px; padding-right: 0px; padding-top: 10px; text-align: justify;"><code style="background-attachment: initial; background-clip: initial; background-color: #fafafa; background-image: initial; background-origin: initial; border-bottom-color: rgb(234, 234, 234); border-bottom-style: solid; border-bottom-width: 1px; border-image: initial; border-left-color: rgb(65, 138, 181); border-left-style: solid; border-left-width: 5px; border-right-color: rgb(234, 234, 234); border-right-style: solid; border-right-width: 1px; border-top-color: rgb(234, 234, 234); border-top-style: solid; border-top-width: 1px; display: block; font-family: 'Lucida Console', 'courier new', monospace; font-size: 1em; line-height: 1.5em; margin-bottom: 5px; margin-left: 0px; margin-right: 0px; margin-top: 5px; overflow-x: auto; overflow-y: auto; padding-bottom: 10px; padding-left: 10px; padding-right: 10px; padding-top: 10px; text-align: left;"># High Density Scatterplot with Binning<br style="margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px; padding-bottom: 0px; padding-left: 0px; padding-right: 0px; padding-top: 0px;" />library(hexbin)<br style="margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px; padding-bottom: 0px; padding-left: 0px; padding-right: 0px; padding-top: 0px;" />x &lt;- rnorm(1000)<br style="margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px; padding-bottom: 0px; padding-left: 0px; padding-right: 0px; padding-top: 0px;" />y &lt;- rnorm(1000)<br style="margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px; padding-bottom: 0px; padding-left: 0px; padding-right: 0px; padding-top: 0px;" />bin&lt;-hexbin(x, y, xbins=50)&nbsp;<br style="margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px; padding-bottom: 0px; padding-left: 0px; padding-right: 0px; padding-top: 0px;" />plot(bin, main="Hexagonal Binning")</code></div><div class="separator" style="clear: both; text-align: left;"><a href="http://www.statmethods.net/graphs/images/hexbin.jpg" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="320" src="http://www.statmethods.net/graphs/images/hexbin.jpg" width="320" /></a></div><div class="separator" style="clear: both; text-align: left;">Reference:&nbsp;http://www.statmethods.net/graphs/scatterplot.html</div><div class="separator" style="clear: both; text-align: left;"><br /></div><div class="separator" style="clear: both; text-align: left;">Another option is to use transparent color:</div><div class="separator" style="clear: both; text-align: left;"><br style="background-color: #fafafa; color: #444444; font-family: 'Lucida Console', 'courier new', monospace; font-size: 13px; line-height: 19px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px; padding-bottom: 0px; padding-left: 0px; padding-right: 0px; padding-top: 0px;" /></div><span style="background-color: #fafafa; color: #444444; font-family: 'Lucida Console', 'courier new', monospace; font-size: 13px; line-height: 19px;"># define color with transparency</span><br /><div class="separator" style="clear: both; text-align: left;"><span style="background-color: #fafafa; color: #444444; font-family: 'Lucida Console', 'courier new', monospace; font-size: 13px; line-height: 19px;">col="#0000ff22" &nbsp;</span></div><span style="background-color: #fafafa; color: #444444; font-family: 'Lucida Console', 'courier new', monospace; font-size: 13px; line-height: 19px;">plot(x,y, col=col, pch=16, cex=2)</span><br /><div class="separator" style="clear: both; text-align: left;"></div><div class="separator" style="clear: both;"><br /></div><div class="separator" style="clear: both;">The 3rd option is to use smoothScatter().&nbsp;</div><br />